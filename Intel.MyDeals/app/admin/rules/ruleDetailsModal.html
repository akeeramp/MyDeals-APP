<form style="margin-top: 0px;" class="form-horizontal" autocomplete="off">
    <div class="modal-content" id="ruleModal" style="overflow-y:hidden;overflow-x:hidden; border: 1px solid #1a3e6f;border-bottom:none">
        <div class="modal-header modalBlueBody">
            <i id="btnClose" class="intelicon-close-max" ng-click="ok()" title="Click to Close"></i>
            <i id="btnModalAnchordisable" class="intelicon-locked-outlined" title="Click to Enable dragging"></i>
            <i id="btnModalEnlargeText" class="intelicon-increase-text-outlined" title="Click to Decrese Text"></i>
            <h3 id="modalTitle">Rule Configuration Details</h3>

        </div>

        <div class="modal-body">
            <form id="mainForm" style="margin-top: 10px; max-height:590px" class="form-horizontal bigFont">

                <div ng-include="'app/admin/rules/rulesSimulationModal.html'"></div>

                <div>
                    <div ng-show="false" class="form-group row">
                        <label class="control-label col-md-2">Rule:</label>
                        <div class="col-md-9">
                            <select class="form-control md"
                                    kendo-combo-box
                                    k-options="vm.ruleOptions"
                                    ng-model="vm.rule.Id"
                                    style="width:100%"></select>
                        </div>
                    </div>

                    <div class="col-md-9" style="font-size: 12px; margin: 0; padding: 0; text-align: right;" ng-if="vm.rule.ChangedBy.length > 0">
                        Last modified by <span style="color:#00AEEF">{{vm.rule.ChangedBy}}</span> on <span style="color:#00AEEF">{{vm.rule.ChangeDateTimeFormat}} GMT</span>
                    </div>
                    <div class="col-md-2" style="font-size: 12px; margin: 0; padding: 0; text-align: right; width:100%">
                    </div>

                    <div class="form-group row">
                        <label class="control-label isRequired col-md-2" autocomplete="off">Name:</label>
                        <div class="col-md-7">
                            <input class="form-control md"
                                   type="text"
                                   ng-model="vm.rule.Name"
                                   style="width:100%">
                        </div>
                        <div class="tooltipPriceRule col-md-2">
                            <toggle class="fl toggle-accept" ng-disabled="(!(vm.isElligibleForApproval && vm.rule.IsAutomationIncluded))"
                                    ng-model="vm.rule.RuleStage"
                                    on="Approved"
                                    off="Approve"
                                    onstyle="btn-success"
                                    offstyle="btn-danger"
                                    title="{{vm.rule.RuleStage == true ? 'Approved' : 'Approve'}}" ng-click="vm.UpdateRuleIndicator(vm.rule.Id, vm.rule.RuleStage,'UPDATE_STAGE_IND',(vm.isElligibleForApproval && vm.rule.IsActive && vm.rule.IsAutomationIncluded))"></toggle>
                        </div>
                    </div>

                    <div class="form-group row">
                        <label class="control-label isRequired col-md-2">Owner:</label>
                        <div class="col-md-2">
                            <span style="line-height:35px;" title="{{vm.rule.OwnerId}}">{{vm.rule.OwnerName}}</span>                            
                        </div>
                        <label class="control-label col-md-2">Rule Status:</label>
                        <span class="col-md-2" style="float: left;">
                            <div class="tooltipPriceRule">
                                <toggle class="fl toggle-accept" ng-disabled="vm.rule.RuleStage == false"
                                        ng-model="vm.rule.IsActive"
                                        on="Active"
                                        off="Inactive"
                                        onstyle="btn-success"
                                        offstyle="btn-danger"
                                        title="{{vm.rule.IsActive == true ? 'Active' : 'Inactivate'}}" ng-click="vm.UpdateRuleIndicator(vm.rule.Id, vm.rule.IsActive,'UPDATE_ACTV_IND',true, vm.rule.RuleStage)"></toggle>
                                 </div>
                        </span>

                        <label class="control-label col-md-1" style="float: left;">Rule Type:</label>
                        <span class="col-md-2" style="float: left;">
                            <div class="tooltipPriceRule">
                                <toggle class="fl toggle-accept"
                                        ng-model="vm.rule.IsAutomationIncluded"
                                        on="Auto Approval"
                                        ng-click="vm.toggleType(vm.rule.IsAutomationIncluded)"
                                        off="Exclusion Rule"
                                        onstyle="btn-success"
                                        offstyle="btn-danger"
                                        title="{{vm.rule.IsAutomationIncluded == true ? 'Auto Approval' : 'Exclusion from Automation'}}"></toggle>
                                 </div>
                        </span>

                        
                    </div>

                    <div class="form-group row">
                        
                        <label class="control-label isRequired col-md-2">Start Date:</label>
                        <div class="col-md-2">
                            <input kendo-date-picker
                                   placeholder="From date"
                                   k-ng-model="vm.rule.StartDate"
                                   style="width: 100%;" />
                        </div>
                        <label class="control-label isRequired col-md-2">End Date:</label>
                        <div class="col-md-2">
                            <input kendo-date-picker
                                   placeholder="To date"
                                   k-ng-model="vm.rule.EndDate"
                                   style="width: 100%;" />
                        </div>
                    </div>


                    <div class="form-group row">
                        <label class="control-label col-md-2">Notes:</label>
                        <div class="col-md-9">
                            <textarea type="textarea" rows="5" ng-model="vm.rule.Notes" style="width:100%"></textarea>
                        </div>
                    </div>

                    <div class="form-group row">
                        <label class="control-label col-md-2">Criteria:</label>
                        <div ng-if="vm.loadCriteria == true" class="col-md-9">
                            <div rule-attribute-builder
                                 grid-id="'attributeGrid'"
                                 operator-settings="operatorSettings"
                                 attribute-settings="attributeSettings"
                                 criteria="vm.rule.Criteria"
                                 custom-settings="">
                            </div>
                        </div>
                    </div>

                    <div class="form-group row" ng-if="vm.rule.IsAutomationIncluded">
                        <label class="control-label col-md-2">Blanket Discount:</label>
                        <div class="col-md-6" id="blanket_section">
                            <span>Requested ECAP must be no less than</span>
                            <input kendo-numeric-text-box ng-model="vm.BlanketDiscountPercentage" ng-change="vm.EditBlanketDiscountPercentage()" k-decimals="0" k-format="'#'" k-min="0" k-max="70" style="width: 100px;font-size:11px;" />
                            <span>%&nbsp;Or&nbsp;$</span>
                            <input kendo-numeric-text-box ng-model="vm.BlanketDiscountDollor" ng-change="vm.EditBlanketDiscountDollor()" k-format="'n2'" k-min="0" style="width: 130px;font-size:11px;" />
                            <span>off of CAP</span>
                        </div>
                    </div>
                </div>
                <div style="display:none;"><!--Dummy button to prevent events while press enter key in textbox--><button /></div>
                <div class="form-group row" id="productCriteria">
                    <label class="control-label col-md-2">Product Criteria:</label>
                    <div class="col-md-9">
                        <kendo-spreadsheet id="spreadsheetProductCriteria" style="width: 602px; height: 300px; margin-right: 25px;  float:left;" k-options="spreadSheetOptions" k-scope-field="spreadsheet" k-sheets="sheets"></kendo-spreadsheet>
                        <button ng-click="vm.validateProduct(true,false,false)" class="btn btn-primary" style="float: left;">Validate Products</button>
                    </div>
                </div>
                <div class="form-group row" id="productCriteria">&nbsp;</div>
            </form>
        </div>
        <div class="modal-footer">
            <div class="form-group row action_btns">
                <div class="col-md-7">
                    <button ng-click="vm.saveRule('SAVE_AS_DRAFT',false)" class="btn btn-primary" style="margin-left: 15px">Save as Draft</button>
                    <button ng-click="vm.saveRule('SUBMIT',true)" class="btn btn-primary" style="margin-left: 15px">Submit</button>
                    <button ng-click="vm.cancel()" class="btn btn-primary" style="margin-left: 15px">Cancel</button>
                    <button ng-click="vm.simulate()" class="btn btn-success" style="margin-left: 15px;" title="Rule must be Saved as Draft to run simulation" ng-disabled="vm.rule.Id == 0">Simulate</button>
                </div>
            </div>
        </div>

    </div>
</form>
    <script type="text/javascript">
        $(".modal-content").resizable({
            handles: 'e, w'
        });
        //Intializing the Draggble function for the first time
        $('.modal-dialog').draggable();
        //Disabled it cause by default it will be disabled
        $('.modal-dialog').draggable('disable');
        //Draggble Toggle button for the User- Click to Enable.Disablen
        $('#btnModalAnchordisable').click(function (e) {
            $('.modal-dialog').draggable('disable');
            if ($('#btnModalAnchordisable').attr('class').trim() == 'intelicon-locked-outlined') {
                $('.modal-dialog').draggable('enable');
                $('#btnModalAnchordisable').removeClass('intelicon-locked-outlined').addClass('intelicon-unlocked-outlined');
                $('#btnModalAnchordisable').attr('title', 'Click me to Disable Dragging');
            } else {
                $('.modal-dialog').draggable('disable');
                $('#btnModalAnchordisable').removeClass('intelicon-unlocked-outlined').addClass('intelicon-locked-outlined');
                $('#btnModalAnchordisable').attr('title', 'Click me to Enable Dragging');
            }

        });
        $('#btnModalEnlargeText').click(function (e) {
            if ($('#btnModalEnlargeText').attr('class').trim() == 'intelicon-decrease-text-outlined') {
                $('#btnModalEnlargeText').removeClass('intelicon-decrease-text-outlined').addClass('intelicon-increase-text-outlined');
                $('#mainForm').removeClass('bigFont').addClass('fontSmall');
                $('#btnModalEnlargeText').attr('title', 'Click me to Decrease Text size');
            } else {
                $('#btnModalEnlargeText').removeClass('intelicon-increase-text-outlined').addClass('intelicon-decrease-text-outlined');
                $('#mainForm').removeClass('fontSmall').addClass('bigFont');
                $('#btnModalEnlargeText').attr('title', 'Click me to Increase Text size');
            }
        });

        $('#modal-window').on('show.bs.modal', function () {
            $(this).find('.modal-body').css({
                'max-height': '100%'
            });
        });
    </script>
    <script>
        $(document).ready(function () {
            $('#bodyContent').attr('style', 'overflow: auto !important');
            $($('#spreadsheetProductCriteria .k-spreadsheet-column-header').find('div')[0]).find('div').html('Product Name (Only Lvl 4 or Material Ids Allowed)');
            $($('#spreadsheetProductCriteria .k-spreadsheet-column-header').find('div')[2]).find('div').html('ECAP Floor (US$)');
        });
    </script>
    <style>
        .modal-footer {
            position: fixed;
            bottom: -59px;
            width: 100%;
            background: #efefef;
            height: 60px;
            /* float: left; */
            border: 1px solid #003c71;
            margin-left: -2px;
        }

        .modal-content {
            max-height: 600px;
        }

        .modal-dialog {
            width: 90%;
        }

        .fontSmall {
            font-size: 12px !important;
        }

        .bigSmall {
            font-size: 15px !important;
        }

        #modalTitle {
            float: left;
            margin-top: -30px;
        }

        .modal-body {
            overflow-y: scroll;
            max-height: calc(95vh - 170px);
            width: 100%;
            border-bottom: none;
        }

        .modalBlueBody {
            background-color: #003C71;
            color: #ffffff;
        }

        .modal-header {
            padding: 25px;
            border-bottom: 1px solid #e5e5e5;
            min-height: 16.5px;
        }

        #btnModalAnchordisable {
            float: right;
            margin-left: 94.5%;
            background: transparent;
            border: 1px solid #00aeef;
            padding: 3px;
            cursor: pointer;
            font-size: 22px;
            margin-top: -30px;
            z-index: 999999999;
            margin-right: 70px;
        }

        #btnModalEnlargeText {
            float: right;
            background: transparent;
            border: 1px solid #00aeef;
            padding: 3px;
            cursor: pointer;
            font-size: 22px;
            margin-top: -30px;
            z-index: 99999;
            margin-right: 35px;
        }

        #btnClose {
            float: right;
            margin-top: -15px;
            background: transparent;
            border: 1px solid #00aeef;
            padding: 3px;
            font-size: 22px;
            cursor: pointer;
        }
    </style>
