<form style="margin-top:15px" class="form-horizontal">
    <div ng-if="!vm.isEditmode" class="col-md-12" style="padding-top: 20px;">
        <div class="k-header k-grid-toolbar ng-scope">
            <a role="button" class="k-button k-button-icontext k-grid-add" ng-click="vm.addNewRule()">
                <span class="k-icon k-i-plus"></span>Add New Rule
            </a>
        </div>
        <div kendo-grid class="table" expand-k-grid options="vm.gridOptions"></div>
    </div>
    <div class="col-md-7" ng-if="vm.isEditmode">
        <div ng-show="false" class="form-group row">
            <label class="control-label col-md-2">Rule:</label>
            <div class="col-md-10">
                <select class="form-control md"
                        kendo-combo-box
                        k-options="vm.ruleOptions"
                        ng-model="vm.rule.Id"
                        style="width:100%"></select>
            </div>
        </div>
        <div class="form-group row">
            <label class="control-label col-md-2">Name:</label>
            <div class="col-md-10">
                <input class="form-control md"
                       type="text"
                       ng-model="vm.rule.Name" ng-change="vm.IsDuplicateTitle($event)"
                       style="width:100%">
            </div>
        </div>
        <div class="form-group row" ng-if="vm.IsDuplicateName">
            <label class="control-label col-md-2">&nbsp</label>
            <div class="col-md-10">
                <div class="err-Control ng-binding ng-scope" style="">This rule name already exists in another rule.</div>
            </div>
        </div>
        <div class="form-group row">
            <label class="control-label col-md-2">Owner:</label>
            <div class="col-md-10">
                <select kendo-combo-box
                        k-options="vm.ownerOptions"
                        ng-model="vm.rule.OwnerId"
                        style="width:100%"></select>
            </div>
        </div>
        <div class="form-group row">
            <label class="control-label col-md-2">Status:</label>
            <div class="col-md-2">
                <toggle class="fl toggle-accept"
                        ng-model="vm.rule.IsActive"
                        on="Active"
                        off="Inactive"
                        onstyle="btn-success"
                        offstyle="btn-danger"></toggle>
            </div>
            <label class="control-label col-md-2">Stage:</label>
            <div class="col-md-4" style="margin-left:-15px;">
                <toggle class="fl toggle-accept" ng-disabled="!vm.RuleConfig.IsElligibleForApproval"
                        ng-model="vm.rule.RuleStage"
                        on="Approved"
                        off="Pending"
                        onstyle="btn-success"
                        offstyle="btn-danger"></toggle>
            </div>
            <!--<label class="control-label col-md-1">Automation:</label>
            <div class="col-md-2" style="margin-left:-15px;">
                <toggle class="fl toggle-accept"
                        ng-model="vm.rule.IsAutomationIncluded"
                        on="Include"
                        off="Exclude"
                        onstyle="btn-success"
                        offstyle="btn-danger"></toggle>
            </div>-->
        </div>
        <div class="form-group row">
            <label class="control-label col-md-2">Rule Start Date:</label>
            <div class="col-md-2">
                <input kendo-date-picker
                       placeholder="From date"
                       k-ng-model="vm.rule.StartDate"
                       style="width: 100%;" />
            </div>
            <label class="control-label col-md-2">End Date:</label>
            <div class="col-md-2">
                <input kendo-date-picker
                       placeholder="To date"
                       ng-model="vm.rule.EndDate"
                       style="width: 100%;margin-left:-15px;" />
            </div>
        </div>
        <div class="form-group row">
            <label class="control-label col-md-2">Notes:</label>
            <div class="col-md-10">
                <textarea type="textarea" rows="5"
                          ng-model="vm.rule.Notes"
                          style="width:100%" />
            </div>
        </div>
        <div ng-if="vm.rule.Id > 0" class="form-group row" style="margin:0px !important;margin-left:-10px !important;">
            <label class="control-label col-md-2">&nbsp;</label>
            <div class="col-md-10" style="font-size: 12px;margin: 0px;padding: 0px;text-align: right;">
                <span>Last modified by </span>
                <span style="color:orangered">{{vm.rule.ChangedBy}}</span>
                <span> on </span>
                <span style="color:orangered">{{vm.rule.ChangeDateTimeFormat}}</span>
            </div>
        </div>
        <div class="form-group row">
            <label class="control-label col-md-2">Criteria:</label>
            <div class="col-md-10">
                <div rule-attribute-builder
                     grid-id="'attributeGrid'"
                     operator-settings="operatorSettings"
                     attribute-settings="attributeSettings"
                     criteria="vm.rule.Criteria"
                     custom-settings=""></div>
            </div>
        </div>

        <div class="form-group row action_btns">
            <label class="control-label col-md-2"></label>
            <div class="col-md-6">
                <button ng-click="vm.saveRule(false)" class="btn btn-primary">Save as Draft</button>
                <button ng-click="vm.cancel()" class="btn btn-primary">Cancel Edits</button>
                <button ng-click="vm.saveRule(true)" class="btn btn-primary">Save & Publish</button>
            </div>
        </div>
    </div>
    <div class="form-group row" style="margin-bottom: 50px;" ng-show="vm.isEditmode">
        <div class="col-md-5">
            <label class="control-label col-md-12" style="text-align:left">Product Criteria: 
                <a href="" ng-hide="vm.isProductGridVisible" ng-click="vm.createProductSheet()">Show Grid</a>                    
            </label>
            <div class="col-md-12">
                <button ng-show="vm.isProductGridVisible" class="k-button" id="save" role="button" ng-click="vm.validateProducts(this)">Validate</button>                
            </div>
            <div class="col-md-12" style="margin-top:5px">
                <div id="spreadsheet" style="width: 100%;" k-scope-field="spreadsheet"></div>
            </div>
            

        </div>
    </div>
</form>
<style>
    .k-spreadsheet-action-bar {
        display:none !important;
    }
    .k-spreadsheet-fixed-container{
        margin-left: -33px;
    }
    #productCriteria tbody .k-alt {
        background-color: white !important;
        border-right-color: lightgray !important;
        border-right-width: 1px !important;
        border-bottom-style: solid !important;
    }

    #productCriteria .k-grid-content {
        height: 100% !important;
    }

    .k-button {
        color: #fff;
        background-color: #0071c5;
        border-color: #0071c5;
        box-shadow: none;
    }

        .k-button:hover {
            background-color: #00aeef;
            border-color: #00aeef;
            color: #fff;
            box-shadow: none;
        }

    .tmpltItem {
        width: 100%;
    }

    .tmpltIcn {
        width: 35px;
    }

        .tmpltIcn i {
            font-size: 26px;
        }

    .tmpltContract {
    }

    .tmpltRole {
        font-size: 12px;
    }

    .tmpltPrimary {
        font-size: 14px;
        line-height: 1.1em;
    }

    .tmpltSecondary {
        font-size: 12px;
        line-height: 1.1em;
        opacity: 0.6;
    }

    .toggle {
        width: 120px !important;
    }

    .rulesGidIcon {
        font-size: 20px;
        margin: 3px;
        color: #aaa;
    }

    .action_btns {
        margin-bottom: 20px;
    }
</style>
<script>
    $(document).ready(function () {
        $('#bodyContent').attr('style', 'overflow: auto !important');
    });
</script>
<script>
    function createProductSheet() {        
        $("#spreadsheet").kendoSpreadsheet({
            columns: 2,
            rows: 200,
            toolbar: false,
            sheetsbar: false,
            actionbar: false,
            sheets: [{
                name: "Products",
                rows: [{
                    height: 25,
                    cells: [
                        {
                            value: "ProductName",
                            bold: "true",
                            background: "#045092",
                            textAlign: "center",
                            color: "white"
                        }, {
                            value: "ProductCost",
                            bold: "true",
                            background: "#045092",
                            textAlign: "center",
                            color: "white"
                        }]
                }],
                columns: [
                    { width: 365 },
                    { width: 160 }
                ]
            }]
        });

        $("#save").click(function () {
            if (!$(this).hasClass("k-state-disabled")) {
                //dataSource.sync();
            }
        });

        $("#cancel").click(function () {
            if (!$(this).hasClass("k-state-disabled")) {
                //dataSource.cancelChanges();
            }
        });
    }
        

</script>