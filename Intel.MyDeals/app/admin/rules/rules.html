<form style="margin-top:15px" class="form-horizontal">
    <div ng-if="!vm.isEditmode" class="col-md-12" style="padding-top: 20px;">
        <div class="k-header k-grid-toolbar ng-scope">
            <a role="button" class="k-button k-button-icontext k-grid-add" ng-click="vm.addNewRule()">
                <span class="k-icon k-i-plus"></span>Add New Rule
            </a>
        </div>
        <div kendo-grid class="table" expand-k-grid options="vm.gridOptions"></div>
    </div>
    <div ng-if="vm.isEditmode">
        <div ng-show="false" class="form-group row">
            <label class="control-label col-md-2">Rule:</label>
            <div class="col-md-5">
                <select class="form-control md"
                        kendo-combo-box
                        k-options="vm.ruleOptions"
                        ng-model="vm.rule.Id"
                        style="width:100%"></select>
            </div>
        </div>
        <div class="form-group row">
            <label class="control-label col-md-2">Name:</label>
            <div class="col-md-5">
                <input class="form-control md"
                       type="text"
                       ng-model="vm.rule.Name"
                       style="width:100%">
            </div>
        </div>

        <div class="form-group row">
            <label class="control-label col-md-2">Owner:</label>
            <div class="col-md-5">
                <select kendo-combo-box
                        k-options="vm.ownerOptions"
                        ng-model="vm.rule.OwnerId"
                        style="width:100%"></select>
            </div>
        </div>
        <div class="form-group row">
            <label class="control-label col-md-2">Status:</label>
            <div class="col-md-1">
                <toggle class="fl toggle-accept"
                        ng-model="vm.rule.IsActive"
                        on="Active"
                        off="Inactive"
                        onstyle="btn-success"
                        offstyle="btn-danger"></toggle>
            </div>
            <label class="control-label col-md-1">Stage:</label>
            <div class="col-md-1" style="margin-left:-15px;">
                <toggle class="fl toggle-accept" ng-disabled="!vm.RuleConfig.IsElligibleForApproval"
                        ng-model="vm.rule.RuleStage"
                        on="Approved"
                        off="Pending"
                        onstyle="btn-success"
                        offstyle="btn-danger"></toggle>
            </div>
            <label class="control-label col-md-1">Automation:</label>
            <div class="col-md-1" style="margin-left:-15px;">
                <toggle class="fl toggle-accept"
                        ng-model="vm.rule.IsAutomationIncluded"
                        on="Include"
                        off="Exclude"
                        onstyle="btn-success"
                        offstyle="btn-danger"></toggle>
            </div>
        </div>
        <div class="form-group row">
            <label class="control-label col-md-2">Rule Start Date:</label>
            <div class="col-md-2">
                <input kendo-date-picker
                       placeholder="From date"
                       k-ng-model="vm.rule.StartDate"
                       style="width: 100%;" />
            </div>
            <label class="control-label col-md-1">End Date:</label>
            <div class="col-md-2">
                <input kendo-date-picker
                       placeholder="To date"
                       ng-model="vm.rule.EndDate"
                       style="width: 100%;" />
            </div>
        </div>
        <div class="form-group row">
            <label class="control-label col-md-2">Notes:</label>
            <div class="col-md-5">
                <textarea type="textarea" rows="5"
                          ng-model="vm.rule.Notes"
                          style="width:100%" />
            </div>
        </div>
        <div ng-if="vm.rule.Id > 0" class="form-group row" style="margin:0px !important;margin-left:-10px !important;">
            <label class="control-label col-md-2">&nbsp;</label>
            <div class="col-md-5" style="font-size: 12px;margin: 0px;padding: 0px;text-align: right;">
                <span>Last modified by </span>
                <span style="color:orangered">{{vm.rule.ChangedBy}}</span>
                <span> on </span>
                <span style="color:orangered">{{vm.rule.ChangeDateTimeFormat}}</span>
            </div>
        </div>
        <div class="form-group row">
            <label class="control-label col-md-2">Criteria:</label>
            <div class="col-md-6">
                <div rule-attribute-builder
                     grid-id="'attributeGrid'"
                     operator-settings="operatorSettings"
                     attribute-settings="attributeSettings"
                     criteria="vm.rule.Criteria"
                     custom-settings=""></div>
            </div>
        </div>
        <div class="form-group row">
            <label class="control-label col-md-2">Blanket Discount:</label>
            <div class="col-md-6" id="blanket_section">
                <span>Requested ECAP must be no less than</span>
                <input kendo-numeric-text-box ng-model="vm.BlanketDiscountPercentage" ng-change="vm.EditBlanketDiscountPercentage()" k-decimals="0" k-format="'#'" k-min="0" k-max="100" style="width: 100px;font-size:11px;" />
                <span>%&nbsp;Or&nbsp;$</span>
                <input kendo-numeric-text-box ng-model="vm.BlanketDiscountDollor" ng-change="vm.EditBlanketDiscountDollor()" k-format="'n2'" k-min="0" style="width: 130px;font-size:11px;" />
                <span>off of CAP</span>
            </div>
        </div>
    </div>
    <div class="form-group row" id="productCriteria">
        <label class="control-label col-md-2">Product Criteria:</label>
        <div class="col-md-5">
            <kendo-spreadsheet style="width:100%;height:300px;" k-scope-field="spreadsheet" k-sheets="sheets"></kendo-spreadsheet>
        </div>
    </div>
    <div class="form-group row action_btns" ng-if="vm.isEditmode">
        <label class="control-label col-md-2"></label>
        <div class="col-md-6">
            <button ng-click="vm.saveRule(false)" class="btn btn-primary">Save</button>
            <button ng-click="vm.cancel()" class="btn btn-primary">Cancel</button>
            <button ng-click="vm.saveRule(true)" class="btn btn-primary">Publish</button>
            <button ng-click="vm.validateProduct()" class="btn btn-primary">Validate Products</button>
        </div>
    </div>
</form>
<style>
    div.k-spreadsheet-formula-bar,
    .k-resize-handle {
        display: none !important;
    }
    
    .k-animation-container ul li:nth-child(5), .k-animation-container ul li:nth-child(4) {
        display: none;
    }

    .k-spreadsheet-action-bar {
        display: none !important;
    }

    .k-spreadsheet-fixed-container {
        margin-left: -33px;
    }

    .k-grid-header, .k-grid-header .k-header, .k-pager-wrap, .k-pager-numbers .k-state-selected, .k-grid-footer, .k-grid-footer td, .k-scheduler-header, .km-pane-wrapper .k-grid-header .k-header {
        background-color: #f3f3f3 !important;
    }

    .k-grid .k-alt {
        background-color: rgba(241, 241, 241, 0.17) !important;
    }

    .dealTools .md-icon {
        padding: 4px 0 0 5px;
    }

    .true {
        background-color: rgb(196, 214, 0) !important;
    }

    .dealTools .md-icon i {
        color: #00AEEF !important;
    }

        .dealTools .md-icon i:hover {
            color: #003C71 !important;
        }

    .dealTools .md-icon-disabled {
        padding: 4px 2px 0 1px;
    }

        .dealTools .md-icon-disabled i {
            color: #00AEEF;
        }

    .dealTools {
        margin-left: -5px !important;
    }

    .dealTools {
        line-height: 1.8em;
        height: 100% !important;
        width: 100%;
    }

        .dealTools .gridStatusMarker {
            font-family: arial;
        }

        .dealTools a {
            text-decoration: none;
        }

        .dealTools i:hover {
            color: #003C71;
        }

    .gridStatusMarker {
        width: 16px;
        color: #000000;
        background-color: #cccccc;
        font-size: 14px;
        font-weight: 600;
        padding: 4px 2px 4px 7px;
        margin-left: -10px;
        margin-right: 15px;
    }

        .gridStatusMarker.Working {
            color: #000000;
            background-color: #FFA300;
        }

        .gridStatusMarker.Active {
            color: #000000;
            background-color: #C4D600;
        }

        .gridStatusMarker.Cancelled {
            color: #000000;
            background-color: #cccccc;
        }

    .dealTools .md-icon {
        padding: 4px 0 0 5px;
    }

    .ruleName {
        cursor: pointer;
    }

        .ruleName:hover {
            color: #abadaf;
        }

    .k-tabstrip-wrapper, .k-tabstrip-bottom, k-spreadsheet-sheets-bar-add {
        display: none;
    }

    #blanket_section span {
        font-size: 12px;
    }

    .k-button {
        color: #fff;
        background-color: #0071c5;
        border-color: #0071c5;
        box-shadow: none;
    }

        .k-button:hover {
            background-color: #00aeef;
            border-color: #00aeef;
            color: #fff;
            box-shadow: none;
        }

    .tmpltItem {
        width: 100%;
    }

    .tmpltIcn {
        width: 35px;
    }

        .tmpltIcn i {
            font-size: 26px;
        }

    .tmpltContract {
    }

    .tmpltRole {
        font-size: 12px;
    }

    .tmpltPrimary {
        font-size: 14px;
        line-height: 1.1em;
    }

    .tmpltSecondary {
        font-size: 12px;
        line-height: 1.1em;
        opacity: 0.6;
    }

    .toggle {
        width: 120px !important;
    }

    .rulesGidIcon {
        font-size: 20px;
        margin: 3px;
        color: #aaa;
        margin-right: 10px;
    }

    .action_btns {
        margin-bottom: 20px;
    }
</style>
<script>
    $(document).ready(function () {
        $('#bodyContent').attr('style', 'overflow: auto !important');
        $($('.k-spreadsheet-column-header').find('div')[0]).find('div').html('Product Name');
        $($('.k-spreadsheet-column-header').find('div')[2]).find('div').html('Price');
    });
</script>