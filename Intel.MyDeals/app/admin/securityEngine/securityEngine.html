
<div class="container-fluid">
    <div class="row full" style="margin-left: 15px">
        <div id="sidebar" class="col-md-3">
            <div ng-show="!vm.isDropdownsLoaded">
                Loading dropdown data...
            </div>

            <!-- SIDE BAR -->
            <div class="secEngine_sidebar" ng-show="vm.isDropdownsLoaded">
                <div id="secEngine_filters" class="row">
                    <div class="lbl">
                        <h6>
                            Security Attributes Properties
                            <!-- Help button -->
                            <i class="intelicon-help-outlined" ng-click="vm.clickHelpButton()" style="cursor: pointer; color: #0071C5;"></i>
                        </h6>
                    </div>
                    <div class="lbl">
                        <div>ObjType: </div>
                        <div class="opUiContainer md">
                            <select style="width: 160px;" id="serviceAccounts" kendo-drop-down-list="vm.id.ObjType" k-options="vm.dropDownOptions.objType" k-ng-model="vm.selected.objType" k-ng-delay="vm.isDropdownsLoaded"></select>
                        </div>
                        <div class="clearboth"></div>
                    </div>
                    <div class="lbl">
                        <div>Roles: </div>
                        <div class="opUiContainer md">
                            <select kendo-multi-select k-options="vm.dropDownOptions.roleType" k-ng-model="vm.selected.roles" k-ng-delay="vm.isDropdownsLoaded"></select>
                        </div>
                        <div class="clearboth"></div>
                    </div>
                    <div class="lbl">
                        <div>Stages: </div>
                        <div class="opUiContainer md">
                            <select kendo-multi-select="vm.dropDown.wfStage" k-options="vm.dropDownOptions.wfStage" k-ng-model="vm.selected.stages" k-ng-delay="vm.isDropdownsLoaded"></select>
                        </div>
                        <div class="clearboth"></div>
                    </div>
                    <div class="lbl">
                        <div>ObjSet Types: </div>
                        <div class="opUiContainer md">
                            <select id="OBJ_SET_TYPE_SID" kendo-multi-select="vm.dropDown.objSetType" k-options="vm.dropDownOptions.dealType" k-ng-model="vm.selected.dealTypes" k-ng-delay="vm.isDropdownsLoaded"></select>
                        </div>
                        <div class="clearboth"></div>
                    </div>

                    <!-- Tabs -->
                    <div class="col-md-12 secEngine_tabs">
                        <uib-tabset active="" style="margin: 6px;">
                            <uib-tab index="0" heading="Attribute Security" select="vm.selectTabMode(vm.tabModeEnum.AtrbSecurity)">
                                <div class="col-md-12">
                                    <!-- Attribute Security -->
                                    <div class="row">
                                        <div class="col-md-12">Attribute Action: </div>
                                        <div class="col-md-12 opUiContainer md">
                                            <select style="width: 100%;" kendo-drop-down-list k-options="vm.dropDownOptions.attrAction" k-ng-model="vm.selected.attrAction" k-ng-delay="vm.isDropdownsLoaded"></select>
                                        </div>
                                    </div>
                                    <div class="row" style="padding-top:20px;">
                                        <div class="col-md-4">Attributes: </div>
                                        <div class="col-md-8">
                                            <!-- Magic wand -->
                                            <i ng-click="vm.magicWandSelect()" class="fr fa fa-magic clickable" title="Let me guess" tooltip-placement="left" uib-tooltip="Click this to get a best guess of what attributes you'd want"></i>
                                        </div>
                                        <div class="col-md-12 opUiContainer md">
                                            <select id="dropDownAttributes" kendo-multi-select="vm.dropDown.attributes" k-options="vm.dropDownOptions.attributes" k-ng-model="vm.selected.attributes" k-ng-value="vm.selected.attributes" k-ng-delay="vm.isDropdownsLoaded"></select>
                                        </div>
                                    </div>

                                </div>
                                <div class="clearboth"></div>
                            </uib-tab>
                            <uib-tab index="1" heading="Deal Security" select="vm.selectTabMode(vm.tabModeEnum.DealSecurity)" ng-click="vm.changeTabs()">
                                <div class="col-md-12 opUiContainer sm">
                                    <!-- Deal Security -->
                                    Deal Action:
                                    <select kendo-multi-select k-options="vm.dropDownOptions.dealAction" k-ng-model="vm.selected.dealActions" k-ng-delay="vm.isDropdownsLoaded"></select>
                                </div>
                                <div class="clearboth"></div>
                            </uib-tab>
                            <!--
                        <uib-tab index="2" heading="...">
                            <div class="col-md-12">
                                <i class='intelicon-more'> </i>
                                Other attirbute types coming soon.
                                TODO: put a popover here with the other attribute types to choose from.
                            </div>
                            <div class="clearboth"></div>
                        </uib-tab>-->
                        </uib-tabset>
                    </div>
                </div>
                <!-- BUTTON -->
                <div class="row secEngine_viewButton">
                    <button class="btn btn-primary col-md-12" ng-click="vm.getGridData()">View Security Attributes<i class="intelicon-arrow-forward-right"></i></button>
                </div>
            </div>
        </div>
        <div id="main" class="col-md-9">
            <div class="row">

                <!-- Main block -->
                <div class="col-md-12">

                    <div class="col-md-12">
                        <div ng-show="vm.isGridLoading">
                            <h3>Loading grid data... </h3>
                            <p>
                                Please note that this may take several minutes, depending on what filters you have chosen. <br />
                                The webpage may also freeze during this time. This is normal and the page will be interactable once again after the load time is over.
                            </p>
                        </div>
                    </div>

                    <div ng-show="!vm.isShowMainContent">
                        <p><h3>Please select grid filters on the left sidebar.</h3></p>
                        <p><i>Detailed Instructions:</i></p>
                        <ol>
                            <li>On the left-hand side menu, select the ObjType, Roles, Stages and ObjSet types you want to view. Note that leaving the select blank will default to "ALL".</li>
                            <li>Select either the "Attribute Security" or "Deal Security" tab and enter remaining details.</li>
                            <li>When done, click the "View Security Attributes" button on the bottom.</li>
                        </ol>
                    </div>
                    <div ng-show="vm.isShowMainContent && !vm.isGridLoading">
                        <div class="col-md-12">
                            <div class="row">

                                <h5 class="col-md-6" style="margin-top:8px"><b>Action:</b> <span style="padding-left:20px"></span> {{ vm.currentDisplayAction }}</h5>

                                <!-- Deal Type Color Key -->
                                <div class="col-md-6">
                                    <div class="fr" style="font-size: 8px; line-height: 1em;">
                                        <div class="atrbbasecolorECAP fl atrbContainer secEngine_key">&nbsp;</div>
                                        <div class="fl secEngine_keyBlock"> = ECAP</div>

                                        <div class="atrbbasecolorPROGRAM fl atrbContainer secEngine_key">&nbsp;</div>
                                        <div class="fl secEngine_keyBlock"> = PROGRAM</div>

                                        <div class="atrbbasecolorVOL_TIER fl atrbContainer secEngine_key">&nbsp;</div>
                                        <div class="fl secEngine_keyBlock"> = VOL TIER</div>

                                        <div class="atrbbasecolorFLEX fl atrbContainer secEngine_key">&nbsp;</div>
                                        <div class="fl secEngine_keyBlock"> = FLEX</div>

                                        <div class="atrbbasecolorKIT fl atrbContainer secEngine_key">&nbsp;</div>
                                        <div class="fl secEngine_keyBlock"> = KIT</div>

                                        <div class="atrbbasecolor fl atrbContainer secEngine_key" style="border-color: red;">&nbsp;</div>
                                        <div class="fl secEngine_keyBlock"> = Other (hover on box to see)</div>

                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Grid -->
                        <div class="row">
                            <div class="col-md-12">
                                <div id="secEngineGrid" kendo-grid="vm.securityEngineGrid" expand-k-grid class="table" options="vm.mainGridOptions" k-rebind="vm.mainGridOptions"></div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



<script type="text/x-kendo-template" id="toolBarTemplate">
	<!-- custom toolbar with custom save -->
	<button class="btn btn-primary" ng-click="vm.save()">Save</button>
	<button class="btn btn-primary" ng-click="vm.reset()">Reset</button>
</script>


<script>
	// Handle resize
    $(window).resize(function () {
		resizeContent();
	});

	$(document).ready(function () {
		window.setTimeout(function () {
		    resizeContent();
		}, 100);
	});

	function resizeContent() {
		var offset = 155;
		var contentHeight = $(window).height() - offset;

		$("#secEngine_filters").css("height", contentHeight);
    }
</script>

