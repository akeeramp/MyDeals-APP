<loading-panel show="isBusy" header="isBusyMsgTitle" description="isBusyMsgDetail" msg-type="isBusyType" is-show-fun-fact="isBusyShowFunFact" ng-show="isBusy"></loading-panel>

<div ng-if="isDataAvaialable" ng-show="isVisible" class="meetComp-show-hide">
    <div id="meetCompOvrrd" class="col-md-12">
        <div style="margin-bottom:4px">
            <button class="btn btn-sm ssToolbarBtn fl"
                    style="padding: 5px 0px;"
                    ng-click="saveAndRunMeetComp()">
                <table>
                    <tbody>
                        <tr>
                            <td>
                                <div class="btn btn-skyblue-sm"><i class="fa fa-refresh fa-fw iconRunPct" style="font-size: 20px"></i></div>
                            </td>
                            <td class="skyblue-text" style="padding-left: 5px; text-align: left; font-size: 12px;">
                                Save &amp; Validate<br> Meet Comp
                            </td>
                        </tr>
                    </tbody>
                </table>
            </button>

            <div class="fr" style="padding: 0 5px; width: auto;">
                <div ng-bind="lastMeetCompRunCalc()" class="btnLastRun meetCompbtnLastRun" style="font-size: 15px" title="{{lastMetCompRunLocalTime}}"></div>
            </div>

            <div class="fr helpBtn" title="Help" onclick="showHelpTopic(HelpTopicEnum.MeetComp_AutoPopulation);">
                <i class="intelicon-help" style="font-size:30px !important"></i>
            </div>

            <div class="clearboth"></div>
        </div>

        <div id="grid" kendo-grid="meetCompGrid" class="opUiContainer md dashboard" ng-class="{'op-grid': isAdhoc != 1}" expand-k-grid options="gridOptions"></div>
    </div>
</div>

<script>
    function openDealDetails(DEAL_OBJ_SID, GRP_PRD_SID, DEAL_PRD_TYPE) {
        var scope = angular.element(document.getElementById("meetCompOvrrd")).scope();
        scope.$apply(function () {
            scope.getDealDeatils(DEAL_OBJ_SID, GRP_PRD_SID, DEAL_PRD_TYPE);
        });

    }
    function gotoDealDetails(CNTRCT_OBJ_SID, PRC_ST_OBJ_SID, PRC_TBL_OBJ_SID, DEAL_OBJ_SID) {
        var win = window.open("Contract#/manager/" + CNTRCT_OBJ_SID + "/" + PRC_ST_OBJ_SID + "/" + PRC_TBL_OBJ_SID + "/wip?searchTxt=" + DEAL_OBJ_SID, '_blank');
        win.focus();
    }
	$( document ).ready(function() {
		var result = window.setInterval(function(){	
		  var scope = angular.element(document.getElementById("meetCompOvrrd")).scope();		  
		  if(typeof scope != 'undefined'){
			  if(scope.isAdhoc == 1){				  
				  $('.k-i-expand').click();
				  if($( "a" ).hasClass('k-i-collapse')){
					clearInterval(result);
				  }
				}else if(scope.isAdhoc == 0){
					clearInterval(result);
				}
			}
		}, 1500);
		
	});
</script>

<style>
    .meetComp-show-hide {
        transition: all linear 0.5s;
    }

        .meetComp-show-hide.ng-hide {
            opacity: 0;
        }

    .btnPctMct {
        font-size: 14px;
        margin-top: 4px;
        line-height: 1.0em;
    }

    .btnLastRun {
        font-size: 9px;
        color: #00AEEF;
        line-height: 1.1em;
    }

    .btn-skyblue-sm {
        background-color: #00AEEF;
        border: 1px solid #00AEEF;
        color: #ffffff;
        border-radius: 4px;
        padding: 2px !important;
    }

    .skyblue-text {
        color: #00AEEF;
        line-height: 1em;
        padding: 2px 6px !important;
    }

    .btn-skyblue-sm:hover {
        background-color: #0071C5;
        border: 1px solid #0071C5;
        color: #ffffff;
    }

    .btn-skyblue-sm i {
        font-size: 20px;
        margin: 0;
        padding: 0;
    }

    .readOnlyCell {
        color: #000 !important;
        background-color: rgba(0,0,0,.05) !important;
        height: 100% !important;
        text-align: left;
        padding-top: 8px;
        padding-left: 5px;
        margin-left: -5px;
    }

    #tabstrip h2 {
        font-weight: lighter;
        font-size: 5em;
        line-height: 1;
        padding: 0 0 0 30px;
        margin: 0;
    }

        #tabstrip h2 span {
            background: none;
            padding-left: 5px;
            font-size: .3em;
            vertical-align: top;
        }

    #tabstrip p {
        margin: 0;
        padding: 0;
    }

    .textRunIcon {
        width: 100% !important;
        text-align: center !important;
    }

    .k-hierarchy-cell {
        border-right: none !important;
    }

    .anchorSaveAndValidate {
        background: transparent !important;
        box-shadow: none !important;
        border: none !important;
        color: #ffffff !important;
    }

    .btnSaveAndValidate {
        color: #ffffff;
        font-size: 20px;
        margin-right: 5px;
    }

    .childGrid .k-grid-content {
        overflow: hidden !important;
    }

    .k-detail-row > .k-detail-cell > div:first-child {
        margin: 0px !important;
        margin-left: -6px !important;
        overflow: hidden !important;
    }

    .complete {
        font-size: 20px !important;
        color: #0071c5;
    }

    .completeGreen {
        font-size: 20px !important;
        color: #c4d600;
    }

    .inComplete, .incomplete {
        font-size: 20px !important;
        color: #F3D54E;
    }

    .errorListRow {
        /*background: rgba(255, 221, 221, 0.59) !important;*/
        background: transparent !important;
    }

    .errorItemList {
        border-color: rgb(255, 0, 0) !important;
        border: 1px solid rgb(255, 0, 0) !important;
    }

    .errorIcon {
        font-size: 20px !important;
        color: rgb(255, 0, 0);
    }

    .notRunYetIcon {
        font-size: 20px !important;
        color: #c7c7c7;
    }

    .notApplicableIcon {
        font-size: 20px !important;
        color: #c7c7c7;
    }

    .k-grid-content > table > tbody > tr > td {
        padding-left: 5px !important;
    }

    .btnYes {
        background: #a49d00 !important;
        color: black;
    }

    .btnNo {
        background: #FC4C02 !important;
        color: black;
    }

    .btnDeal {
        cursor: pointer;
    }

    .undolnk {
        background: #FC4C02;
        color: white;
        padding-left: 5px;
        padding-right: 5px;
        padding-top: 3px;
        padding-bottom: 3px;
        border-radius: 3px;
        cursor: pointer;
    }

    .ovlpCell {
        padding-left: 5px !important;
    }

    #overLapping .op-grid.k-grid tr td {
        padding-left: 5px !important;
    }

    .detailsDiv {
        margin: 0;
        padding: 0;
    }

    .lnk {
        background: #00AEEF;
        color: white;
        padding-left: 5px;
        padding-right: 5px;
        padding-top: 3px;
        padding-bottom: 3px;
        border-radius: 3px;
        cursor: pointer;
    }

    .k-dialog.k-alert .k-dialog-titlebar, .k-dialog.k-confirm .k-dialog-titlebar, .k-dialog.k-prompt .k-dialog-titlebar {
        display: none;
    }

    .k-menu .k-item > .k-link {
        padding: 4px 0.5em;
        color: #00AEEF;
    }

        .k-menu .k-item > .k-link:hover {
            color: #FFFFFF;
        }

    .dealTools input[type=radio].with-font,
    .dealTools input[type=checkbox].with-font {
        border: 0;
        clip: rect(0 0 0 0);
        height: 1px;
        margin: -1px;
        overflow: hidden;
        padding: 0;
        position: absolute;
        width: 1px;
    }

        .dealTools input[type=radio].with-font + label:before,
        .dealTools input[type=checkbox].with-font + label:before {
            font-family: FontAwesome;
            display: inline-block;
            content: "\f096";
            font-size: 20px;
            letter-spacing: 10px;
            color: #00AEEF;
            margin-left: 10px;
        }

        .dealTools input[type=radio].with-font:hover + label:before,
        .dealTools input[type=checkbox].with-font:hover + label:before {
            color: #003C71;
            cursor: pointer;
        }

        .dealTools input[type=radio].with-font.disabled + label:before,
        .dealTools input[type=checkbox].with-font.disabled + label:before {
            color: #cccccc;
            cursor: default;
        }

        .dealTools input[type=radio].with-font:checked + label:before,
        .dealTools input[type=checkbox].with-font:checked + label:before {
            content: "\f046";
            font-size: 20px;
            letter-spacing: 5px;
            color: #C4D600;
            margin-left: 10px;
        }

        .dealTools input[type=radio].with-font:focus + label:before,
        .dealTools input[type=checkbox].with-font:focus + label:before {
            font-weight: bold;
            color: #00AEEF;
        }

        .dealTools input[type=radio].with-font:checked:focus + label:before,
        .dealTools input[type=checkbox].with-font:checked:focus + label:before {
            font-weight: bold;
            color: #C4D600;
        }

    .delete-attach-icon {
        font-size: 16px;
        cursor: pointer;
    }

        .delete-attach-icon:hover {
            text-decoration: none;
        }
</style>
