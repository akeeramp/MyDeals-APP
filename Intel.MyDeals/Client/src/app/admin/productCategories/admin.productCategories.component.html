<link href="/Client/src/app/admin/kendo_grid.css" rel="stylesheet" />
<div class="row">
	<div class="col-md-12" style="padding-left: 30px; padding-top: 24px">
		<h3 class="heading-alignOnproduct">Product Vertical Rules</h3>
	</div>
	<div class="col-md-12">
		<div class="messageBox col-md-12" [ngClass]="{'mb-warning': true}" style="padding-left: 25px;">
			<b><i class="intelicon-alert-solid icon-lg"></i> Note: </b>
			Please be aware of potential impacts to live deals & downstream partners before making changes to existing data.
		</div>
	</div>
	<div class="col-md-12 kendo-grid-buttons">
		<div class="excel-sections">
			<button class="btn btn-sm dropdown-toggle tool-hover" style="padding-right: .5rem;" type="button" data-toggle="dropdown">
				<div class="excel-btn-update">
					<i class="intelicon-ms-excel-outlined" style="font-size: 30px;color: #fff"></i>
					<span>Excel Export</span>
					<span class="caret" style="color: #fff; width: 10px;"></span>
				</div>
			</button>
			<ul class="dropdown-menu" id="excelDropDownMenu">
				<li (click)="exportToExcel()" style="cursor: pointer;"><a>Export All Columns, All Data</a></li>
				<li (click)="exportToExcelCustomColumns()" style="cursor: pointer;"><a>Export Current View</a></li>
			</ul>
		</div>
		<kendo-grid class="tt-product-cat productvertical-optimize legal-exception-design kAlignHeaders" [data]="gridData" [loading]="isLoading"
					[pageSize]="state.take" [skip]="state.skip" [sort]="state.sort" [filter]="state.filter" [sortable]="true"
					[pageable]="{type:type,pageSizes: pageSizes,info:info,refresh:true}" filterable="menu"
					(dataStateChange)="dataStateChange($event)" [navigable]="true" (edit)="editHandler($event)"
					(cancel)="cancelHandler($event)" (save)="saveHandler($event)" [resizable]="true" (excelExport)="onExcelExport($event)">
			<ng-template kendoGridToolbarTemplate>
				<button (click)="clearFilter()" class="k-button clearButton">
					<span class="k-icon intelicon-cancel-filter-solid k-icon-md k-family"></span>Clear Filters
				</button>
				<kendo-grid-spacer></kendo-grid-spacer>
				<!--<button type="button" kendoGridExcelCommand>
			<span class="k-icon k-i-file-excel k-icon-md"></span>Export to Excel
		</button>-->
				<button (click)="refreshGrid()" class="k-button clearButton">
					<span class="k-icon k-i-reload k-icon-md"></span>Refresh
				</button>
			</ng-template>
			<kendo-grid-command-column title="" width="150" [headerClass]="{'headerClass':true}">
				<ng-template kendoGridCellTemplate let-isNew="isNew">
					<div class="text-center">
						<button class="k-command-icon" id="command-icon" kendoGridEditCommand>
							<span class="k-icon k-i-edit k-icon-sm edited-icon-color"></span>
						</button>
					</div>
					<div class="text-center">
						<button class="k-command-icon" id="command-icon" kendoGridSaveCommand
								[disabled]="formGroup?.invalid">
							<span class="k-icon k-i-check k-icon-sm"></span>
						</button><button class="k-command-icon"
										 id="command-icon" kendoGridCancelCommand>
							<span class="k-icon k-i-cancel-outline k-icon-sm"></span>
						</button>
					</div>
				</ng-template>
			</kendo-grid-command-column>
			<kendo-grid-column [headerClass]="{'headerClass':true}" field="ACTV_IND" title="Actv Ind" width="120"
							   filter="boolean">
				<ng-template kendoGridCellTemplate let-dataItem="dataItem">
					<div class="text-center">
						<mat-slide-toggle class="toggle-button-custom" [color]="color" [checked]="dataItem.ACTV_IND" disabled></mat-slide-toggle>
					</div>
				</ng-template>
				<ng-template kendoGridEditTemplate let-dataItem="dataItem" let-formGroup="formGroup">
					<div class="text-center">
						<mat-slide-toggle class="toggle-button-custom" [color]="color" [checked]="dataItem.ACTV_IND"
										  [formControl]="formGroup.get('ACTV_IND')"></mat-slide-toggle>
					</div>
				</ng-template>
			</kendo-grid-column>
			<kendo-grid-column [headerClass]="{'headerClass':true}" field="GDM_PRD_TYPE_NM" title="Gdm Product Type"
							   [editable]="false">
				<ng-template kendoGridFilterMenuTemplate let-column="column" let-filter="filter"
							 let-filterService="filterService">
					<multicheck-filter [isPrimitive]="true" [field]="column.field" [currentFilter]="filter"
									   [filterService]="filterService" (valueChange)="filterLoad(column.field)" [data]="GetColumnFilterData(column.field)"></multicheck-filter>
				</ng-template>
			</kendo-grid-column>
			<kendo-grid-column [headerClass]="{'headerClass':true}" field="GDM_VRT_NM" title="GDM Vertical Name"
							   [editable]="false">
				<ng-template kendoGridFilterMenuTemplate let-column="column" let-filter="filter"
							 let-filterService="filterService">
					<multicheck-filter [isPrimitive]="true" [field]="column.field" [currentFilter]="filter"
									   [filterService]="filterService" (valueChange)="filterLoad(column.field)" [data]="GetColumnFilterData(column.field)"></multicheck-filter>
				</ng-template>
			</kendo-grid-column>
			<kendo-grid-column [headerClass]="{'headerClass':true}" field="DIV_NM" title="Division Short Name"
							   width="200" [editable]="false">
				<ng-template kendoGridFilterMenuTemplate let-column="column" let-filter="filter"
							 let-filterService="filterService">
					<multicheck-filter [isPrimitive]="true" [field]="column.field" [currentFilter]="filter"
									   [filterService]="filterService" (valueChange)="filterLoad(column.field)" [data]="GetColumnFilterData(column.field)"></multicheck-filter>
				</ng-template>
			</kendo-grid-column>
			<kendo-grid-column [headerClass]="{'headerClass':true}" field="OP_CD" title="Op Code" width="120"
							   [editable]="false">
				<ng-template kendoGridFilterMenuTemplate let-column="column" let-filter="filter"
							 let-filterService="filterService">
					<multicheck-filter [isPrimitive]="true" [field]="column.field" [currentFilter]="filter"
									   [filterService]="filterService" (valueChange)="filterLoad(column.field)" [data]="GetColumnFilterData(column.field)"></multicheck-filter>
				</ng-template>
			</kendo-grid-column>
			<kendo-grid-column [headerClass]="{'headerClass':true}" field="DEAL_PRD_TYPE" title="Deal Product Type">
				<ng-template kendoGridFilterMenuTemplate let-column="column" let-filter="filter"
							 let-filterService="filterService">
					<multicheck-filter [isPrimitive]="true" [field]="column.field" [currentFilter]="filter"
									   [filterService]="filterService" (valueChange)="filterLoad(column.field)" [data]="GetColumnFilterData(column.field)"></multicheck-filter>
				</ng-template>
				<ng-template kendoGridEditTemplate let-dataItem="dataItem" let-formGroup="formGroup">
					<kendo-textbox ngbTooltip="Deal Product Type is required when row is active." (mouseover)="openTooltip()"
								   (mouseout)="closeTooltip()"
								   tooltipClass="toolTipReq redColorTooltip" placement="bottom" container="body" triggers="manual"
								   #dealPdctTooltip="ngbTooltip" [autoClose]="false" [formControl]="formGroup.get('DEAL_PRD_TYPE')"
								   [clearButton]="true"></kendo-textbox>
				</ng-template>
			</kendo-grid-column>
			<kendo-grid-column [headerClass]="{'headerClass':true}" field="PRD_CAT_NM" title="Product Vertical">
				<ng-template kendoGridFilterMenuTemplate let-column="column" let-filter="filter"
							 let-filterService="filterService">
					<multicheck-filter [isPrimitive]="true" [field]="column.field" [currentFilter]="filter"
									   [filterService]="filterService" (valueChange)="filterLoad(column.field)" [data]="GetColumnFilterData(column.field)"></multicheck-filter>
				</ng-template>
				<ng-template kendoGridEditTemplate let-dataItem="dataItem" let-formGroup="formGroup">
					<kendo-textbox ngbTooltip="Product Vertical is required when row is active." (mouseover)="productVerticalTooltipOpen()"
								   (mouseout)="productVerticalTooltipClose()"
								   tooltipClass="toolTipReq redColorTooltip" placement="bottom" container="body" triggers="manual"
								   #pdctVerticalTooltip="ngbTooltip" [autoClose]="false"
								   [formControl]="formGroup.get('PRD_CAT_NM')" [clearButton]="true"></kendo-textbox>
				</ng-template>
			</kendo-grid-column>
			<kendo-grid-column [headerClass]="{'headerClass':true}" field="CHG_EMP_NM" title="Last Updated By"
							   [editable]="false">
				<ng-template kendoGridFilterMenuTemplate let-column="column" let-filter="filter"
							 let-filterService="filterService">
					<multicheck-filter [isPrimitive]="true" [field]="column.field" [currentFilter]="filter"
									   [filterService]="filterService" (valueChange)="filterLoad(column.field)" [data]="GetColumnFilterData(column.field)"></multicheck-filter>
				</ng-template>
			</kendo-grid-column>
			<kendo-grid-column [headerClass]="{'headerClass':true}" field="CHG_DTM" title="Last Update Date"
							   filter="date" format="{0:M/d/yyyy}" [editable]="false">
				<ng-template kendoGridFilterMenuTemplate let-filter="filter" let-column="column"
							 let-filterService="filterService">
					<date-range-filter [field]="column.field" [filter]="filter" [filterService]="filterService">
					</date-range-filter>
				</ng-template>
				<ng-template kendoGridCellTemplate let-dataItem>
					{{dataItem.CHG_DTM | date: 'M/d/yyyy h:mm a'}}
				</ng-template>
			</kendo-grid-column>
			<!--<kendo-grid-excel fileName="MyDealsProductVerticals.xlsx" [fetchData]="allData">
				<kendo-excelexport-column *ngFor="let item of excelColumns | keyvalue : returnZero" field="{{item.key}}"
										  title="{{item.value}}" [width]="150" [cellOptions]="cellOptions"
										  [headerCellOptions]="headerCellOptions"></kendo-excelexport-column>
			</kendo-grid-excel>-->
		</kendo-grid>
	</div>
</div>