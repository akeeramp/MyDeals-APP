<link href="/Client/src/app/admin/kendo_grid.css" rel="stylesheet" />
﻿<div class="row">
    <div class="col-md-12" style="padding-left: 30px; padding-top: 24px">
        <h3 class="bottom-sremove">Data Quality</h3>
    </div>
</div>
<div class="row" style="display: contents;">
    <div class="col-md-12 kendo-grid-buttons table-fix-lf">
        <kendo-grid class="KendoDQInfo grid_height kAlignHeaders" [data]="gridData" [loading]="isLoading" [pageSize]="state.take" 
                    [skip]="state.skip" [sort]="state.sort" [filter]="state.filter" [sortable]="true"
                    [pageable]="{type:type,pageSizes: pageSizes,info:info}" [groupable]="false" [group]="state.group"
                    filterable="menu" [navigable]="true" (dataStateChange)="dataStateChange($event)" [columnMenu]="true"
                    (excelExport)="onExcelExport($event)">
            <ng-template kendoGridToolbarTemplate>
                <button (click)="clearFilter()" class="k-button clearButton">
                    <span class="k-icon intelicon-cancel-filter-solid k-icon-md k-family"></span>Clear Filters
                </button>
                <kendo-grid-spacer></kendo-grid-spacer>
                <button type="button" kendoGridExcelCommand>
                    <span class="k-icon k-i-file-excel k-icon-md"></span>Export to Excel
                </button>
                <button (click)="refreshGrid()" class="k-button clearButton">
                    <span class="k-icon k-i-reload k-icon-md"></span>Refresh
                </button>
            </ng-template>
            <kendo-grid-command-column width="100" [headerClass]="{'headerClass':true}" [columnMenu]="false">
                <ng-template kendoGridCellTemplate let-isNew="isNew" let-dataItem="dataItem">
                    <div class="text-center" kendoTooltip>
                        <button id="command-icon" class="k-command-icon">
                            <span class="k-icon k-i-play k-icon-sm ano-icon-fix" title="Run DQ"
                                  (click)="runDQ(dataItem.DQ_USE_CASE_CD)"></span>
                        </button>
                    </div>
                </ng-template>
            </kendo-grid-command-column>
            <kendo-grid-column width="350" [headerClass]="{'headerClass':true}" field="DQ_USE_CASE_CD" title="Use Case">
            </kendo-grid-column>
            <kendo-grid-column [headerClass]="{'headerClass':true}" field="DQ_USE_CASE_DSC" title="Description">
            </kendo-grid-column>
            <kendo-grid-excel fileName="MyDealsDQReports.xlsx" [fetchData]="allData">
                <kendo-excelexport-column *ngFor="let item of excelColumns | keyvalue : returnZero" field="{{item.key}}"
                                          title="{{item.value}}" [width]="150" [cellOptions]="cellOptions"
                                          [headerCellOptions]="headerCellOptions"></kendo-excelexport-column>>
            </kendo-grid-excel>
        </kendo-grid>
    </div>
</div>