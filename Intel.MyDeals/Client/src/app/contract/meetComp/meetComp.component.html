<link href="/Client/node_modules/@progress/kendo-theme-bootstrap/dist/all.css" rel="stylesheet" />
<link href="/Client/node_modules/@angular/material/prebuilt-themes/indigo-pink.css" rel="stylesheet" />
<link href="/Client/src/app/admin/kendo_grid.css" rel="stylesheet" />
<loading-panel-angular class="meetCompLoader" [show]="isLoading" [header]="spinnerMessageHeader" [description]="spinnerMessageDescription" [msgType]="'Info'" [isShowFunFact]="true">
</loading-panel-angular>
<div *ngIf="isDataAvaialable" class="meetComp-show-hide meet-conduct meet-comp-blank_space">
    <div class="row row-cooperate">
        <div id="meetCompOvrrd" class="col-md-12">
            <div style="margin-bottom:4px">
                <button class="btn btn-sm ssToolbarBtn fl" style="padding: 5px 0px;" (click)="saveAndRunMeetComp()">
                    <table>
                        <tbody>
                            <tr style="border-bottom:none;">
                                <td>
                                    <div class="btn btn-skyblue-sm">
                                        <i class="fa fa-refresh fa-fw iconRunPct"
                                           style="color:#fff; font-size: 25px"></i>
                                    </div>
                                </td>
                                <td class="skyblue-text" style="padding-left: 5px; text-align: left; font-size: 15px;">
                                    Save
                                    &amp; Validate<br>Meet Comp
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </button>
                <div *ngIf="PAGE_NM !='MCTPOPUP'" class="fr" style="padding: 0 5px; width: auto;">
                    <div class="btnLastRun meetCompbtnLastRun" style="font-size: 15px" title="{{lastMetCompRunLocalTime}}">
                        {{lastMeetCompRunValue}}
                    </div>
                </div>
                <div class="fr helpBtn" title="Help" (click)="showHelpTopic();"><i class="intelicon-help" style="font-size:30px !important"></i></div>
                <div class="clearboth"></div>
            </div>
            <div id="grid" class="opUiContainer md dashboard either-pin" [ngClass]="{'op-grid': isAdhoc !=1}">
                <kendo-grid style="height: calc(100vh - 280px); " [data]="gridData" [skip]="state.skip" [sortable]="true" [sort]="state.sort" [pageSize]="state.take" [group]="state.group" [navigable]="true" [resizable]="true" [pageable]="{type:'numeric',pageSizes: pageSizes,info:true,refresh:true}"
                            [groupable]="false" [reorderable]="true" (dataStateChange)="dataStateChange($event)" [filter]="state.filter" filterable="menu" (cellClick)="cellClickHandler($event)" (cellClose)="cellCloseHandler($event)" [kendoGridExpandDetailsBy]="expandDetailsBy" [(expandedDetailKeys)]="expandedDetailKeys" [initiallyExpanded]="isTender">
                    <kendo-grid-column width="70px" [columnMenu]="false">
                        <ng-template kendoGridHeaderTemplate let-column let-columnIndex="columnIndex">
                            <div class='dealTools'>
                                <input type='checkbox' class='grid-link-checkbox with-font' id='lnkChk_header' (click)="selectProdIDS('all', $event)"><label class="all-labels" for='lnkChk_header' style='margin: 5px 0 0 0;' title='Check to apply changes to all checked rows'></label>
                            </div>
                        </ng-template>
                        <ng-template kendoGridCellTemplate let-dataItem>
                            <div *ngIf="(dataItem.MEET_COMP_UPD_FLG.toLowerCase()=='n');else chkbx_template"></div>
                            <ng-template #chkbx_template>
                                <div class='dealTools'>
                                    <input type='checkbox' [(ngModel)]="dataItem.IS_SELECTED" class='grid-link-checkbox with-font' id="lnkChk_{{dataItem.RW_NM}}" (click)="selectProdIDS(dataItem.RW_NM, $event)"><label class="all-labels" for='lnkChk_{{dataItem.RW_NM}}'
                                                                                                                                                                                                                         style='margin: 5px 0 0 0;' title='Check to apply changes to all checked rows'></label>
                                </div>
                            </ng-template>
                        </ng-template>
                    </kendo-grid-column>
                    <kendo-grid-column field="PRD_CAT_NM" title="Vertical" width="100" [headerClass]="{'headerClass':true}">
                        <ng-template kendoGridFilterMenuTemplate let-column="column" let-filter="filter" let-filterService="filterService">
                            <multicheck-filter class="meet-comp-filter" [isPrimitive]="true" [field]="column.field" [currentFilter]="filter" [filterService]="filterService" [data]="distinctPrimitive(column.field)">
                            </multicheck-filter>
                        </ng-template>
                        <ng-template kendoGridCellTemplate let-dataItem="dataItem">
                            <div class='readOnlyCell' title="{{dataItem.PRD_CAT_NM}}">{{dataItem.PRD_CAT_NM}}</div>
                        </ng-template>
                    </kendo-grid-column>
                    <kendo-grid-column field="GRP_PRD_NM" title="Product" width="130" [headerClass]="{'headerClass':true}">
                        <ng-template kendoGridFilterMenuTemplate let-column="column" let-filter="filter" let-filterService="filterService">
                            <multicheck-filter class="meet-comp-filter" [isPrimitive]="true" [field]="column.field" [currentFilter]="filter" [filterService]="filterService" [data]="distinctPrimitive(column.field)">
                            </multicheck-filter>
                        </ng-template>
                        <ng-template kendoGridCellTemplate let-dataItem="dataItem">
                            <div class='readOnlyCell' title="{{dataItem.GRP_PRD_NM}}">{{dataItem.GRP_PRD_NM}}</div>
                        </ng-template>
                    </kendo-grid-column>
                    <kendo-grid-column field="DEAL_OBJ_SID" title="Deals" width=150 [headerClass]="{'headerClass':true}">
                        <ng-template kendoGridFilterMenuTemplate let-column="column" let-filter="filter" let-filterService="filterService">
                            <multicheck-filter class="meet-comp-filter" [isPrimitive]="true" [field]="column.field" [currentFilter]="filter" [filterService]="filterService" [data]="distinctPrimitive(column.field)">
                            </multicheck-filter>
                        </ng-template>
                        <ng-template kendoGridCellTemplate let-dataItem="dataItem">
                            <div class='readOnlyCell' title="{{dataItem.DEAL_OBJ_SID}}">{{dataItem.DEAL_OBJ_SID}}</div>
                        </ng-template>
                    </kendo-grid-column>
                    <kendo-grid-column field="END_CUST_RETAIL" title="End Customer/Retail" width="190" [headerClass]="{'headerClass':true}">
                        <ng-template kendoGridFilterMenuTemplate let-column="column" let-filter="filter" let-filterService="filterService">
                            <multicheck-filter class="meet-comp-filter" [isPrimitive]="true" [field]="column.field" [currentFilter]="filter" [filterService]="filterService" [data]="distinctPrimitive(column.field)">
                            </multicheck-filter>
                        </ng-template>
                        <ng-template kendoGridCellTemplate let-dataItem>
                            <div title='End Customer' class='readOnlyCell'></div>
                        </ng-template>
                    </kendo-grid-column>
                    <kendo-grid-column field="COMP_SKU" title="Meet Comp SKU" width="170" [headerClass]="{'headerClass':true}">
                        <ng-template kendoGridFilterMenuTemplate let-column="column" let-filter="filter" let-filterService="filterService">
                            <multicheck-filter class="meet-comp-filter" [isPrimitive]="true" [field]="column.field" [currentFilter]="filter" [filterService]="filterService" [data]="distinctPrimitive(column.field)">
                            </multicheck-filter>
                        </ng-template>
                        <ng-template kendoGridCellTemplate let-dataItem>
                            <div style="padding-left: 5px;" [ngClass]="{'readOnlyCell' : (usrRole == 'DA' || isEditableGrid == 'False'),'errorListRow errorItemList' : (dataItem.errObj && dataItem.errObj.COMP_SKU) }">{{dataItem.COMP_SKU}}</div>
                        </ng-template>
                        <ng-template kendoGridEditTemplate let-dataItem="dataItem" let-formGroup="formGroup" let-column="column">
                            <kendo-combobox #custDropDown *ngIf="canUpdateMeetCompSKUPriceBench && dataItem.MEET_COMP_UPD_FLG == 'Y'" [data]="meetCompSkuDropdownData" [kendoDropDownFilter]="filterSettings" textField="COMP_SKU" valueField="COMP_SKU" placeholder="Select Comp SKU"
                                            [allowCustom]="true" [valueNormalizer]="valueNormalizerCompSku" (valueChange)="onCompSkuChange($event,dataItem)">
                            </kendo-combobox>
                        </ng-template>
                    </kendo-grid-column>
                    <kendo-grid-column field="COMP_PRC" title="Meet Comp Price" width="170" [headerClass]="{'headerClass':true}">
                        <ng-template kendoGridFilterMenuTemplate let-column="column" let-filter="filter" let-filterService="filterService">
                            <multicheck-filter class="meet-comp-filter" [isPrimitive]="true" [field]="column.field" [currentFilter]="filter" [filterService]="filterService" [data]="distinctPrimitive(column.field)">
                            </multicheck-filter>
                        </ng-template>
                        <ng-template kendoGridCellTemplate let-dataItem>
                            <div [ngClass]="{'readOnlyCell' : (usrRole == 'DA' || isEditableGrid == 'False'),'errorListRow errorItemList' : (dataItem.errObj && dataItem.errObj.COMP_PRC)}">
                                <div *ngIf="(dataItem.COMP_PRC==0 || dataItem.COMP_PRC==null);else comp_prc"></div>
                                <ng-template #comp_prc>
                                    <div style="padding-left: 5px;">${{dataItem.COMP_PRC}} </div>
                                </ng-template>
                            </div>
                        </ng-template>
                        <ng-template kendoGridEditTemplate let-dataItem="dataItem" let-formGroup="formGroup" let-column="column">
                            <kendo-combobox #custDropDown *ngIf="canUpdateMeetCompSKUPriceBench && dataItem.MEET_COMP_UPD_FLG == 'Y' && dataItem.COMP_SKU.length !== 0" [data]="meetCompPrcDropdownData" [kendoDropDownFilter]="filterSettings" textField="COMP_PRC" valueField="COMP_PRC"
                                            placeholder="Select Comp PRC" [allowCustom]="true" [valueNormalizer]="valueNormalizerCompPrc" (valueChange)="onCompPriceChange($event,dataItem)"></kendo-combobox>
                        </ng-template>
                    </kendo-grid-column>
                    <kendo-grid-column field="CAP" title="CAP" width="120" [headerClass]="{'headerClass':true}">
                        <ng-template kendoGridFilterMenuTemplate let-column="column" let-filter="filter" let-filterService="filterService">
                            <multicheck-filter class="meet-comp-filter" [isPrimitive]="true" [field]="column.field" [currentFilter]="filter" [filterService]="filterService" [data]="distinctPrimitive(column.field)">
                            </multicheck-filter>
                        </ng-template>
                        <ng-template kendoGridCellTemplate let-dataItem>
                            <div *ngIf="dataItem.CAP==0;else cap" class='readOnlyCell' title="0"></div>
                            <ng-template #cap>
                                <div title="{{dataItem.CAP}}" class='readOnlyCell'>${{dataItem.CAP}} </div>
                            </ng-template>
                        </ng-template>
                    </kendo-grid-column>
                    <kendo-grid-column field="IA_BNCH" title="IA Bench" width="120" [headerClass]="{'headerClass':true}">
                        <ng-template kendoGridFilterMenuTemplate let-column="column" let-filter="filter" let-filterService="filterService">
                            <multicheck-filter class="meet-comp-filter" [isPrimitive]="true" [field]="column.field" [currentFilter]="filter" [filterService]="filterService" [data]="distinctPrimitive(column.field)">
                            </multicheck-filter>
                        </ng-template>
                        <ng-template kendoGridCellTemplate let-dataItem>
                            <div [ngClass]="{'readOnlyCell' : (dataItem.PRD_CAT_NM.toLowerCase() != 'svrws' || usrRole == 'DA'),'errorListRow errorItemList' : (dataItem.errObj && dataItem.errObj.IA_BNCH) }">
                                <div *ngIf="(dataItem.IA_BNCH==0 || dataItem.IA_BNCH==null );else Ia_Bnch"></div>
                                <ng-template #Ia_Bnch>
                                    <div>{{dataItem.IA_BNCH}}</div>
                                </ng-template>
                            </div>
                        </ng-template>
                        <ng-template let-dataItem="dataItem" kendoGridEditTemplate let-formGroup="formGroup" let-column="column">
                            <kendo-numerictextbox *ngIf="(canUpdateMeetCompSKUPriceBench && dataItem.MEET_COMP_UPD_FLG === 'Y' && dataItem.COMP_SKU.length !== 0 && dataItem.PRD_CAT_NM.toLowerCase() === 'svrws')" [decimals]="2" [value]="dataItem.IA_BNCH" [min]="0" (valueChange)="onIaBnchChange($event,dataItem)"></kendo-numerictextbox>
                        </ng-template>
                    </kendo-grid-column>
                    <kendo-grid-column field="COMP_BNCH" title="Comp Bench" width="140" [headerClass]="{'headerClass':true}">
                        <ng-template kendoGridFilterMenuTemplate let-column="column" let-filter="filter" let-filterService="filterService">
                            <multicheck-filter class="meet-comp-filter" [isPrimitive]="true" [field]="column.field" [currentFilter]="filter" [filterService]="filterService" [data]="distinctPrimitive(column.field)">
                            </multicheck-filter>
                        </ng-template>
                        <ng-template kendoGridCellTemplate let-dataItem>
                            <div [ngClass]="{'readOnlyCell' : (dataItem.PRD_CAT_NM.toLowerCase() != 'svrws' || usrRole == 'DA'),'errorListRow errorItemList' : (dataItem.errObj && dataItem.errObj.COMP_BNCH) }">
                                <div *ngIf="(dataItem.COMP_BNCH==0 || dataItem.COMP_BNCH==null );else Comp_Bnch"></div>
                                <ng-template #Comp_Bnch>
                                    <div>{{dataItem.COMP_BNCH}}</div>
                                </ng-template>
                            </div>
                        </ng-template>
                        <ng-template let-dataItem="dataItem" kendoGridEditTemplate let-formGroup="formGroup" let-column="column">
                            <kendo-numerictextbox *ngIf="(canUpdateMeetCompSKUPriceBench && dataItem.MEET_COMP_UPD_FLG === 'Y' && dataItem.COMP_SKU.length !== 0 && dataItem.PRD_CAT_NM.toLowerCase() === 'svrws')" [decimals]="2" [value]="dataItem.COMP_BNCH" [min]="0" (valueChange)="onCompBnchChange($event,dataItem)"></kendo-numerictextbox>
                        </ng-template>
                    </kendo-grid-column>
                    <kendo-grid-column [hidden]="hideViewMeetCompResult" field="MEET_COMP_STS" title="Test Results" width="130" [headerClass]="{'headerClass':true}">
                        <ng-template kendoGridFilterMenuTemplate let-column="column" let-filter="filter" let-filterService="filterService">
                            <multicheck-filter class="meet-comp-filter" [isPrimitive]="true" [field]="column.field" [currentFilter]="filter" [filterService]="filterService" [data]="distinctPrimitive(column.field)">
                            </multicheck-filter>
                        </ng-template>
                        <ng-template kendoGridCellTemplate let-dataItem>
                            <div class='readOnlyCell' [ngSwitch]="dataItem.MEET_COMP_STS.toLowerCase()">
                                <span *ngSwitchCase="'fail'">
                                    <icon-mct-pct-angular [dataValue]='dataItem.MEET_COMP_STS' [iconClass]="medIcon" [title]="'Error/Failed'">
                                    </icon-mct-pct-angular>
                                </span>
                                <span *ngSwitchCase="'incomplete'">
                                    <icon-mct-pct-angular [dataValue]='dataItem.MEET_COMP_STS' [iconClass]="medIcon" [title]="'InComplete'">
                                    </icon-mct-pct-angular>
                                </span>
                                <span *ngSwitchCase="'not run yet'">
                                    <icon-mct-pct-angular [dataValue]='dataItem.MEET_COMP_STS' [iconClass]="medIcon" [title]="'Not run yet'">
                                    </icon-mct-pct-angular>
                                </span>
                                <span *ngSwitchCase="'na'">
                                    <icon-mct-pct-angular [dataValue]='dataItem.MEET_COMP_STS' [iconClass]="medIcon" [title]="'NA'">
                                    </icon-mct-pct-angular>
                                </span>
                                <span *ngSwitchCase="'overridden'">
                                    <icon-mct-pct-angular [dataValue]='dataItem.MEET_COMP_STS' [iconClass]="medIcon"
                                                          [title]="'Passed with Override Status'">
                                    </icon-mct-pct-angular>
                                </span>
                                <span *ngSwitchCase="'pass'">
                                    <icon-mct-pct-angular [dataValue]='dataItem.MEET_COMP_STS' [iconClass]="medIcon" [title]="'Passed'">
                                    </icon-mct-pct-angular>
                                </span>
                                <span *ngSwitchDefault>
                                    <icon-mct-pct-angular [dataValue]='dataItem.MEET_COMP_STS' [iconClass]="medIcon">
                                    </icon-mct-pct-angular>
                                </span>
                            </div>
                        </ng-template>
                    </kendo-grid-column>
                    <kendo-grid-column field="MC_AVG_RPU" title="Avg. Net Price" width="150" [headerClass]="{'headerClass':true}">
                        <ng-template kendoGridFilterMenuTemplate let-column="column" let-filter="filter" let-filterService="filterService">
                            <multicheck-filter class="meet-comp-filter" [isPrimitive]="true" [field]="column.field" [currentFilter]="filter" [filterService]="filterService" [data]="distinctPrimitive(column.field)">
                            </multicheck-filter>
                        </ng-template>
                        <ng-template kendoGridCellTemplate let-dataItem>
                            <div class='readOnlyCell' title="{{dataItem.MEET_COMP_FRMULA}}">{{dataItem.MC_AVG_RPU}}</div>
                        </ng-template>
                    </kendo-grid-column>
                    <kendo-grid-column [hidden]="hideViewMeetCompOverride" field="COMP_OVRRD_FLG" title="Analysis Override" width="150" [headerClass]="{'headerClass':true}">
                        <ng-template kendoGridFilterMenuTemplate let-column="column" let-filter="filter" let-filterService="filterService">
                            <multicheck-filter class="meet-comp-filter" [isPrimitive]="true" [field]="column.field" [currentFilter]="filter" [filterService]="filterService" [data]="distinctPrimitive(column.field)">
                            </multicheck-filter>
                        </ng-template>
                        <ng-template kendoGridCellTemplate let-dataItem>
                            <div [ngClass]="{'readOnlyCell' : (dataItem.MEET_COMP_STS.toLowerCase() == 'pass' || ( dataItem.MEET_COMP_STS.toLowerCase() == 'overridden' && dataItem.COMP_OVRRD_FLG.toLowerCase() == 'yes')),'errorListRow errorItemList' : (dataItem.errObj && dataItem.errObj.COMP_OVRRD_FLG) }">
                                {{dataItem.COMP_OVRRD_FLG}}
                            </div>
                        </ng-template>
                        <ng-template let-dataItem="dataItem" kendoGridEditTemplate let-formGroup="formGroup" let-column="column">
                            <div *ngIf=" !(dataItem.MEET_COMP_STS.toLowerCase() == 'pass' || (dataItem.MEET_COMP_STS.toLowerCase() == 'overridden' && dataItem.COMP_OVRRD_FLG.toLowerCase() == 'yes')) && ((usrRole == 'DA') && dataItem.MEET_COMP_OVERRIDE_UPD_FLG.toLowerCase() === 'y')">
                                <kendo-dropdownlist [data]="compOverrideDropdownData" textField="COMP_OVRRD_FLG" valueField="COMP_OVRRD_FLG" [valuePrimitive]="true" [value]="dataItem.COMP_OVRRD_FLG" [defaultItem]="defaultCompOverrideItem" (valueChange)="onCompOverrideFlagChange($event,dataItem)">
                                </kendo-dropdownlist>
                            </div>
                        </ng-template>
                    </kendo-grid-column>
                    <kendo-grid-column [hidden]="hideViewMeetCompOverride" field="COMP_OVRRD_RSN" title="Analysis Override Comments" width="220" [headerClass]="{'headerClass':true}">
                        <ng-template kendoGridFilterMenuTemplate let-column="column" let-filter="filter" let-filterService="filterService">
                            <multicheck-filter class="meet-comp-filter" [isPrimitive]="true" [field]="column.field" [currentFilter]="filter" [filterService]="filterService" [data]="distinctPrimitive(column.field)">
                            </multicheck-filter>
                        </ng-template>
                        <ng-template kendoGridCellTemplate let-dataItem>
                            <div [ngClass]="{'readOnlyCell' : (dataItem.MEET_COMP_STS.toLowerCase() == 'pass' || ( dataItem.MEET_COMP_STS.toLowerCase() == 'overridden' && dataItem.COMP_OVRRD_FLG.toLowerCase() == 'yes')),'errorListRow errorItemList' : (dataItem.errObj && dataItem.errObj.COMP_OVRRD_RSN) }">
                                {{dataItem.COMP_OVRRD_RSN}}
                            </div>
                        </ng-template>
                        <ng-template let-dataItem="dataItem" kendoGridEditTemplate let-formGroup="formGroup" let-column="column">
                            <div *ngIf="!((usrRole == 'DA' && dataItem.MEET_COMP_UPD_FLG == 'Y' && (dataItem.MEET_COMP_STS.toLowerCase() == 'pass' || dataItem.MEET_COMP_STS.toLowerCase() == 'overridden')) || (dataItem.MEET_COMP_UPD_FLG == 'N')) && dataItem.COMP_OVRRD_FLG !=='Select Override'">
                                <kendo-textbox placeholder="Enter Override Comments..." [clearButton]="true" [value]="dataItem.COMP_OVRRD_RSN" (valueChange)="onCompOverrideCommentChange($event,dataItem)">
                                </kendo-textbox>
                            </div>
                        </ng-template>
                    </kendo-grid-column>
                    <kendo-grid-column field="BRND_FMLY" title="Brand / Family" width="140" [headerClass]="{'headerClass':true}">
                        <ng-template kendoGridFilterMenuTemplate let-column="column" let-filter="filter" let-filterService="filterService">
                            <multicheck-filter class="meet-comp-filter" [isPrimitive]="true" [field]="column.field" [currentFilter]="filter" [filterService]="filterService" [data]="distinctPrimitive(column.field)">
                            </multicheck-filter>
                        </ng-template>
                        <ng-template kendoGridCellTemplate let-dataItem="dataItem">
                            <div class='readOnlyCell' title="{{dataItem.BRND_FMLY}}">{{dataItem.BRND_FMLY}}</div>
                        </ng-template>
                    </kendo-grid-column>
                    <kendo-grid-column title="Group Deals" width="150" [headerClass]="{'headerClass':true}">
                        <ng-template kendoGridCellTemplate let-dataItem>
                            <div class='readOnlyCell'></div>
                        </ng-template>
                    </kendo-grid-column>
                    <kendo-grid-column field="MEET_COMP_ANALYSIS" title="Meet Comp Analysis" width="170" [headerClass]="{'headerClass':true}">
                        <ng-template kendoGridFilterMenuTemplate let-column="column" let-filter="filter" let-filterService="filterService">
                            <multicheck-filter class="meet-comp-filter" [isPrimitive]="true" [field]="column.field" [currentFilter]="filter" [filterService]="filterService" [data]="distinctPrimitive(column.field)">
                            </multicheck-filter>
                        </ng-template>
                        <ng-template kendoGridCellTemplate let-dataItem="dataItem">
                            <div class='readOnlyCell'>{{dataItem.MEET_COMP_ANALYSIS}}</div>
                        </ng-template>
                    </kendo-grid-column>
                    <kendo-grid-column title="ECAP Price" width="130" [headerClass]="{'headerClass':true}">
                        <ng-template kendoGridCellTemplate let-dataItem>
                            <div class='readOnlyCell'></div>
                        </ng-template>
                    </kendo-grid-column>
                    <kendo-grid-column title="YCS2 Price" width="130" [headerClass]="{'headerClass':true}">
                        <ng-template kendoGridCellTemplate let-dataItem>
                            <div class='readOnlyCell'></div>
                        </ng-template>
                    </kendo-grid-column>
                    <ng-template kendoGridDetailTemplate let-dataItem>
                        <div id="childGrid" class="opUiContainer md dashboard">
                            <!-- CHILD GRID BEGINS -->
                            <kendo-grid [data]="convertToChildGridArray(dataItem)" [skip]="childState.skip" [sortable]="true" scrollable="boolean" [sort]="childState.sort" [pageSize]="childState.take" [group]="childState.group" [navigable]="true" [resizable]="true" [groupable]="false"
                                        (dataStateChange)="childDataStateChange($event)" [filter]="childState.filter" filterable="menu" (cellClick)="cellClickHandler($event)" (cellClose)="cellCloseHandler($event)" style="height:fit-content !important">
                                <kendo-grid-column field="OBJ_SET_TYPE" title="Deal Type" width="155" [headerClass]="{'headerClass':true}">
                                    <ng-template kendoGridFilterMenuTemplate let-column="column" let-filter="filter" let-filterService="filterService">
                                        <multicheck-filter class="meet-comp-filter" [isPrimitive]="true" [field]="column.field" [currentFilter]="filter" [filterService]="filterService" [data]="distinctPrimitiveChild(column.field)">
                                        </multicheck-filter>
                                    </ng-template>
                                    <ng-template kendoGridCellTemplate let-dataItem="dataItem">
                                        <div class='readOnlyCell' title="{{dataItem.OBJ_SET_TYPE}}">{{dataItem.OBJ_SET_TYPE}}</div>
                                    </ng-template>
                                </kendo-grid-column>
                                <kendo-grid-column field="DEAL_OBJ_SID" title="Deal ID" width="120" [headerClass]="{'headerClass':true}">
                                    <ng-template kendoGridFilterMenuTemplate let-column="column" let-filter="filter" let-filterService="filterService">
                                        <multicheck-filter class="meet-comp-filter" [isPrimitive]="true" [field]="column.field" [currentFilter]="filter" [filterService]="filterService" [data]="distinctPrimitiveChild(column.field)">
                                        </multicheck-filter>
                                    </ng-template>
                                    <ng-template kendoGridCellTemplate let-dataItem="dataItem">
                                        <div class='readOnlyCell'>
                                            <a (click)="gotoDeal(dataItem.DEAL_OBJ_SID)" class="deallink"> {{dataItem.DEAL_OBJ_SID}}</a>
                                        </div>
                                    </ng-template>
                                </kendo-grid-column>
                                <kendo-grid-column field="DEAL_DESC" title="Deal Description" width="140" [headerClass]="{'headerClass':true}">
                                    <ng-template kendoGridFilterMenuTemplate let-column="column" let-filter="filter" let-filterService="filterService">
                                        <multicheck-filter class="meet-comp-filter" [isPrimitive]="true" [field]="column.field" [currentFilter]="filter" [filterService]="filterService" [data]="distinctPrimitiveChild(column.field)">
                                        </multicheck-filter>
                                    </ng-template>
                                    <ng-template kendoGridCellTemplate let-dataItem="dataItem">
                                        <div class='readOnlyCell' title="{{dataItem.DEAL_DESC}}">{{dataItem.DEAL_DESC}}</div>
                                    </ng-template>
                                </kendo-grid-column>
                                <kendo-grid-column field="END_CUST_RETAIL" title="End Customer/Retail" width="177" [headerClass]="{'headerClass':true}">
                                    <ng-template kendoGridFilterMenuTemplate let-column="column" let-filter="filter" let-filterService="filterService">
                                        <multicheck-filter class="meet-comp-filter" [isPrimitive]="true" [field]="column.field" [currentFilter]="filter" [filterService]="filterService" [data]="distinctPrimitiveChild(column.field)">
                                        </multicheck-filter>
                                    </ng-template>
                                    <ng-template kendoGridCellTemplate let-dataItem="dataItem">
                                        <div class='readOnlyCell' title="{{dataItem.END_CUST_RETAIL}}">{{dataItem.END_CUST_RETAIL}}</div>
                                    </ng-template>
                                </kendo-grid-column>
                                <kendo-grid-column field="COMP_SKU" title="Meet Comp SKU" width="155" [headerClass]="{'headerClass':true}">
                                    <ng-template kendoGridFilterMenuTemplate let-column="column" let-filter="filter" let-filterService="filterService">
                                        <multicheck-filter class="meet-comp-filter" [isPrimitive]="true" [field]="column.field" [currentFilter]="filter" [filterService]="filterService" [data]="distinctPrimitiveChild(column.field)">
                                        </multicheck-filter>
                                    </ng-template>
                                    <ng-template kendoGridCellTemplate let-dataItem>
                                        <div style="padding-left:5px;" [ngClass]="{'readOnlyCell' : (usrRole == 'DA' || isEditableGrid == 'False'),'errorListRow errorItemList' : (dataItem.errObj && dataItem.errObj.COMP_SKU)}">{{dataItem.COMP_SKU}}</div>
                                    </ng-template>
                                    <ng-template kendoGridEditTemplate let-dataItem="dataItem" let-formGroup="formGroup" let-column="column">
                                        <kendo-combobox #custDropDown *ngIf="canUpdateMeetCompSKUPriceBench && dataItem.MEET_COMP_UPD_FLG == 'Y'" [data]="meetCompSkuDropdownData" [kendoDropDownFilter]="filterSettings" textField="COMP_SKU" valueField="COMP_SKU" placeholder="Select Comp SKU"
                                                        [allowCustom]="true" [valueNormalizer]="valueNormalizerCompSku" (valueChange)="onCompSkuChange($event,dataItem)"></kendo-combobox>
                                    </ng-template>
                                </kendo-grid-column>
                                <kendo-grid-column field="COMP_PRC" title="Meet Comp Price" width="155" [headerClass]="{'headerClass':true}">
                                    <ng-template kendoGridFilterMenuTemplate let-column="column" let-filter="filter" let-filterService="filterService">
                                        <multicheck-filter class="meet-comp-filter" [isPrimitive]="true" [field]="column.field" [currentFilter]="filter" [filterService]="filterService" [data]="distinctPrimitiveChild(column.field)">
                                        </multicheck-filter>
                                    </ng-template>
                                    <ng-template kendoGridCellTemplate let-dataItem>
                                        <div [ngClass]="{'readOnlyCell' : (usrRole == 'DA' || isEditableGrid == 'False'),'errorListRow errorItemList' : (dataItem.errObj && dataItem.errObj.COMP_PRC)}">
                                            <div *ngIf="(dataItem.COMP_PRC==0 || dataItem.COMP_PRC==null);else comp_prc_c"></div>
                                            <ng-template #comp_prc_c>
                                                <div style="padding-left:5px;">${{dataItem.COMP_PRC}} </div>
                                            </ng-template>
                                        </div>
                                    </ng-template>
                                    <ng-template kendoGridEditTemplate let-dataItem="dataItem" let-formGroup="formGroup" let-column="column">
                                        <kendo-combobox #custDropDown *ngIf="canUpdateMeetCompSKUPriceBench && dataItem.MEET_COMP_UPD_FLG == 'Y' && dataItem.COMP_SKU.length !== 0" [data]="meetCompPrcDropdownData" [kendoDropDownFilter]="filterSettings" textField="COMP_PRC" valueField="COMP_PRC"
                                                        placeholder="Select Comp PRC" [allowCustom]="true" [valueNormalizer]="valueNormalizerCompPrc" (valueChange)="onCompPriceChange($event,dataItem)"></kendo-combobox>
                                    </ng-template>
                                </kendo-grid-column>
                                <kendo-grid-column field="CAP" title="CAP" width="112" [headerClass]="{'headerClass':true}">
                                    <ng-template kendoGridFilterMenuTemplate let-column="column" let-filter="filter" let-filterService="filterService">
                                        <multicheck-filter class="meet-comp-filter" [isPrimitive]="true" [field]="column.field" [currentFilter]="filter" [filterService]="filterService" [data]="distinctPrimitiveChild(column.field)">
                                        </multicheck-filter>
                                    </ng-template>
                                    <ng-template kendoGridCellTemplate let-dataItem>
                                        <div *ngIf="dataItem.CAP==0;else cap_c" class="readOnlyCell" title="0"></div>
                                        <ng-template #cap_c>
                                            <div class="readOnlyCell" title="{{dataItem.CAP}}">
                                                ${{dataItem.CAP}}
                                            </div>
                                        </ng-template>
                                    </ng-template>
                                </kendo-grid-column>
                                <kendo-grid-column field="IA_BNCH" title="IA Bench" width="112" [headerClass]="{'headerClass':true}">
                                    <ng-template kendoGridFilterMenuTemplate let-column="column" let-filter="filter" let-filterService="filterService">
                                        <multicheck-filter class="meet-comp-filter" [isPrimitive]="true" [field]="column.field" [currentFilter]="filter" [filterService]="filterService" [data]="distinctPrimitiveChild(column.field)">
                                        </multicheck-filter>
                                    </ng-template>
                                    <ng-template kendoGridCellTemplate let-dataItem>
                                        <div [ngClass]="{'readOnlyCell' : (dataItem.PRD_CAT_NM.toLowerCase() != 'svrws' || usrRole == 'DA' || (usrRole == 'FSE' && dataItem.PS_STATUS.toLowerCase() != 'draft') || (usrRole == 'GA' && (dataItem.PS_STATUS.toLowerCase() != 'draft' && dataItem.PS_STATUS.toLowerCase() != 'requested') ) ),'errorListRow errorItemList' : (dataItem.errObj && dataItem.errObj.IA_BNCH)}">
                                            <div *ngIf="(dataItem.IA_BNCH==0 || dataItem.IA_BNCH==null );else Ia_Bnch">
                                            </div>
                                            <ng-template #Ia_Bnch>
                                                <div>{{dataItem.IA_BNCH}}</div>
                                            </ng-template>
                                        </div>
                                    </ng-template>
                                    <ng-template let-dataItem="dataItem" kendoGridEditTemplate let-formGroup="formGroup" let-column="column">
                                        <kendo-numerictextbox *ngIf="(canUpdateMeetCompSKUPriceBench && dataItem.MEET_COMP_UPD_FLG === 'Y' && dataItem.COMP_SKU.length !== 0 && dataItem.PRD_CAT_NM.toLowerCase() === 'svrws')" [decimals]="2" [value]="dataItem.IA_BNCH" [min]="0" (valueChange)="onIaBnchChange($event,dataItem)"></kendo-numerictextbox>
                                    </ng-template>
                                </kendo-grid-column>
                                <kendo-grid-column field="COMP_BNCH" title="Comp Bench" width="130" [headerClass]="{'headerClass':true}">
                                    <ng-template kendoGridFilterMenuTemplate let-column="column" let-filter="filter" let-filterService="filterService">
                                        <multicheck-filter class="meet-comp-filter" [isPrimitive]="true" [field]="column.field" [currentFilter]="filter" [filterService]="filterService" [data]="distinctPrimitiveChild(column.field)">
                                        </multicheck-filter>
                                    </ng-template>
                                    <ng-template kendoGridCellTemplate let-dataItem>
                                        <div [ngClass]="{'readOnlyCell' : (dataItem.PRD_CAT_NM.toLowerCase() != 'svrws' || usrRole == 'DA' || (usrRole == 'FSE' && dataItem.PS_STATUS.toLowerCase() != 'draft') || (usrRole == 'GA' && (dataItem.PS_STATUS.toLowerCase() != 'draft' && dataItem.PS_STATUS.toLowerCase() != 'requested') ) ),'errorListRow errorItemList' : (dataItem.errObj && dataItem.errObj.COMP_BNCH)}">
                                            <div *ngIf="(dataItem.COMP_BNCH==0 || dataItem.COMP_BNCH==null );else Comp_Bnch">
                                            </div>
                                            <ng-template #Comp_Bnch>
                                                <div>{{dataItem.COMP_BNCH}}</div>
                                            </ng-template>
                                        </div>
                                    </ng-template>
                                    <ng-template let-dataItem="dataItem" kendoGridEditTemplate let-formGroup="formGroup" let-column="column">
                                        <kendo-numerictextbox *ngIf="(canUpdateMeetCompSKUPriceBench && dataItem.MEET_COMP_UPD_FLG === 'Y' && dataItem.COMP_SKU.length !== 0 && dataItem.PRD_CAT_NM.toLowerCase() === 'svrws')" [decimals]="2" [value]="dataItem.COMP_BNCH" [min]="0" (valueChange)="onCompBnchChange($event,dataItem)"></kendo-numerictextbox>
                                    </ng-template>
                                </kendo-grid-column>
                                <kendo-grid-column [hidden]="hideViewMeetCompResult" [headerClass]="{'headerClass':true}" field="MEET_COMP_STS" title="Test Results" width="120">
                                    <ng-template kendoGridFilterMenuTemplate let-column="column" let-filter="filter" let-filterService="filterService">
                                        <multicheck-filter class="meet-comp-filter" [isPrimitive]="true" [field]="column.field" [currentFilter]="filter" [filterService]="filterService" [data]="distinctPrimitiveChild(column.field)">
                                        </multicheck-filter>
                                    </ng-template>
                                    <ng-template kendoGridCellTemplate let-dataItem>
                                        <div class='readOnlyCell' [ngSwitch]="dataItem.MEET_COMP_STS.toLowerCase()">
                                            <span *ngSwitchCase="'fail'">
                                                <icon-mct-pct-angular [dataValue]='dataItem.MEET_COMP_STS' [iconClass]="medIcon" [title]="'Error/Failed'">
                                                </icon-mct-pct-angular>
                                            </span>
                                            <span *ngSwitchCase="'incomplete'">
                                                <icon-mct-pct-angular [dataValue]='dataItem.MEET_COMP_STS' [iconClass]="medIcon" [title]="'InComplete'">
                                                </icon-mct-pct-angular>
                                            </span>
                                            <span *ngSwitchCase="'not run yet'">
                                                <icon-mct-pct-angular [dataValue]='dataItem.MEET_COMP_STS' [iconClass]="medIcon" [title]="'Not run yet'">
                                                </icon-mct-pct-angular>
                                            </span>
                                            <span *ngSwitchCase="'na'">
                                                <icon-mct-pct-angular [dataValue]='dataItem.MEET_COMP_STS' [iconClass]="medIcon" [title]="'NA'">
                                                </icon-mct-pct-angular>
                                            </span>
                                            <span *ngSwitchCase="'overridden'">
                                                <icon-mct-pct-angular [dataValue]='dataItem.MEET_COMP_STS' [iconClass]="medIcon"
                                                                      [title]="'Passed with Override Status'">
                                                </icon-mct-pct-angular>
                                            </span>
                                            <span *ngSwitchCase="'pass'">
                                                <icon-mct-pct-angular [dataValue]='dataItem.MEET_COMP_STS' [iconClass]="medIcon" [title]="'Passed'">
                                                </icon-mct-pct-angular>
                                            </span>
                                            <span *ngSwitchDefault>
                                                <icon-mct-pct-angular [dataValue]='dataItem.MEET_COMP_STS' [iconClass]="medIcon">
                                                </icon-mct-pct-angular>
                                            </span>
                                        </div>
                                    </ng-template>
                                </kendo-grid-column>
                                <kendo-grid-column field="MC_AVG_RPU" title="Avg. Net Price" width="138" [headerClass]="{'headerClass':true}">
                                    <ng-template kendoGridFilterMenuTemplate let-column="column" let-filter="filter" let-filterService="filterService">
                                        <multicheck-filter class="meet-comp-filter" [isPrimitive]="true" [field]="column.field" [currentFilter]="filter" [filterService]="filterService" [data]="distinctPrimitiveChild(column.field)">
                                        </multicheck-filter>
                                    </ng-template>
                                    <ng-template kendoGridCellTemplate let-dataItem>
                                        <div class='readOnlyCell' title="{{dataItem.MEET_COMP_FRMULA}}">{{dataItem.MC_AVG_RPU}}</div>
                                    </ng-template>
                                </kendo-grid-column>
                                <kendo-grid-column [hidden]="hideViewMeetCompOverride" field="COMP_OVRRD_FLG" title="Analysis Override" width="150" [headerClass]="{'headerClass':true}">
                                    <ng-template kendoGridFilterMenuTemplate let-column="column" let-filter="filter" let-filterService="filterService">
                                        <multicheck-filter class="meet-comp-filter" [isPrimitive]="true" [field]="column.field" [currentFilter]="filter" [filterService]="filterService" [data]="distinctPrimitiveChild(column.field)">
                                        </multicheck-filter>
                                    </ng-template>
                                    <ng-template kendoGridCellTemplate let-dataItem>
                                        <div [ngClass]="{'readOnlyCell' : (dataItem.MEET_COMP_STS.toLowerCase() == 'pass' || ( dataItem.MEET_COMP_STS.toLowerCase() == 'overridden' && dataItem.COMP_OVRRD_FLG.toLowerCase() == 'yes')),'errorListRow errorItemList' : (dataItem.errObj && dataItem.errObj.COMP_OVRRD_FLG) }">
                                            {{dataItem.COMP_OVRRD_FLG}}
                                        </div>
                                    </ng-template>
                                    <ng-template let-dataItem="dataItem" kendoGridEditTemplate let-formGroup="formGroup" let-column="column">
                                        <div *ngIf=" !(dataItem.MEET_COMP_STS.toLowerCase() == 'pass' || (dataItem.MEET_COMP_STS.toLowerCase() == 'overridden' && dataItem.COMP_OVRRD_FLG.toLowerCase() == 'yes')) && ((usrRole == 'DA') && dataItem.MEET_COMP_OVERRIDE_UPD_FLG.toLowerCase() === 'y')">
                                            <kendo-dropdownlist [data]="compOverrideDropdownData" textField="COMP_OVRRD_FLG" valueField="COMP_OVRRD_FLG" [valuePrimitive]="true" [value]="dataItem.COMP_OVRRD_FLG" [defaultItem]="defaultCompOverrideItem" (valueChange)="onCompOverrideFlagChange($event,dataItem)">
                                            </kendo-dropdownlist>
                                        </div>
                                    </ng-template>
                                </kendo-grid-column>
                                <kendo-grid-column [hidden]="hideViewMeetCompOverride" field="COMP_OVRRD_RSN" title="Analysis Override Comments" width="220" [headerClass]="{'headerClass':true}">
                                    <ng-template kendoGridFilterMenuTemplate let-column="column" let-filter="filter" let-filterService="filterService">
                                        <multicheck-filter class="meet-comp-filter" [isPrimitive]="true" [field]="column.field" [currentFilter]="filter" [filterService]="filterService" [data]="distinctPrimitiveChild(column.field)">
                                        </multicheck-filter>
                                    </ng-template>
                                    <ng-template kendoGridCellTemplate let-dataItem>
                                        <div [ngClass]="{'readOnlyCell' : (dataItem.MEET_COMP_STS.toLowerCase() == 'pass' || ( dataItem.MEET_COMP_STS.toLowerCase() == 'overridden' && dataItem.COMP_OVRRD_FLG.toLowerCase() == 'yes')),'errorListRow errorItemList' : (dataItem.errObj && dataItem.errObj.COMP_OVRRD_RSN) }">
                                            {{dataItem.COMP_OVRRD_RSN}}
                                        </div>
                                    </ng-template>
                                    <ng-template let-dataItem="dataItem" kendoGridEditTemplate let-formGroup="formGroup" let-column="column">
                                        <div *ngIf="!(usrRole == 'DA' && dataItem.MEET_COMP_UPD_FLG == 'Y' && (dataItem.MEET_COMP_STS.toLowerCase() == 'pass' || dataItem.MEET_COMP_STS.toLowerCase() == 'overridden')) && dataItem.COMP_OVRRD_FLG !=='Select Override'">
                                            <kendo-textbox placeholder="Enter Override Comments..." [clearButton]="true" [value]="dataItem.COMP_OVRRD_RSN" (valueChange)="onCompOverrideCommentChange($event,dataItem)">
                                            </kendo-textbox>
                                        </div>
                                    </ng-template>
                                </kendo-grid-column>
                                <kendo-grid-column field="BRND_FMLY" title="Brand / Family" width="130" [headerClass]="{'headerClass':true}">
                                    <ng-template kendoGridFilterMenuTemplate let-column="column" let-filter="filter" let-filterService="filterService">
                                        <multicheck-filter class="meet-comp-filter" [isPrimitive]="true" [field]="column.field" [currentFilter]="filter" [filterService]="filterService" [data]="distinctPrimitiveChild(column.field)">
                                        </multicheck-filter>
                                    </ng-template>
                                    <ng-template kendoGridCellTemplate let-dataItem="dataItem">
                                        <div class='readOnlyCell' title="{{dataItem.BRND_FMLY}}">{{dataItem.BRND_FMLY}}</div>
                                    </ng-template>
                                </kendo-grid-column>
                                <kendo-grid-column title="Group Deals" width="138" [headerClass]="{'headerClass':true}">
                                    <ng-template kendoGridCellTemplate let-dataItem="dataItem">
                                        <div class='readOnlyCell' title="{{dataItem.DEAL_DESC}}">
                                            <a (click)="getDealDeatils(dataItem.DEAL_OBJ_SID,dataItem.GRP_PRD_SID,dataItem.DEAL_PRD_TYPE)" style="cursor: pointer;color: #0071c5;" title="Click to view Deal Details">View</a>
                                        </div>
                                    </ng-template>
                                </kendo-grid-column>
                                <kendo-grid-column field="MEET_COMP_ANALYSIS" title="Meet Comp Analysis" width="150" [headerClass]="{'headerClass':true}">
                                    <ng-template kendoGridFilterMenuTemplate let-column="column" let-filter="filter" let-filterService="filterService">
                                        <multicheck-filter class="meet-comp-filter" [isPrimitive]="true" [field]="column.field" [currentFilter]="filter" [filterService]="filterService" [data]="distinctPrimitiveChild(column.field)">
                                        </multicheck-filter>
                                    </ng-template>
                                    <ng-template kendoGridCellTemplate let-dataItem="dataItem">
                                        <div class='readOnlyCell'>{{dataItem.MEET_COMP_ANALYSIS}}</div>
                                    </ng-template>
                                </kendo-grid-column>
                                <kendo-grid-column field="ECAP_PRC" title="ECAP Price" width="120" [headerClass]="{'headerClass':true}">
                                    <ng-template kendoGridFilterMenuTemplate let-column="column" let-filter="filter" let-filterService="filterService">
                                        <multicheck-filter class="meet-comp-filter" [isPrimitive]="true" [field]="column.field" [currentFilter]="filter" [filterService]="filterService" [data]="distinctPrimitiveChild(column.field)">
                                        </multicheck-filter>
                                    </ng-template>
                                    <ng-template kendoGridCellTemplate let-dataItem>
                                        <div *ngIf="dataItem.ECAP_PRC==0;else ecap_prc" class='readOnlyCell' title="0">
                                        </div>
                                        <ng-template #ecap_prc>
                                            <div class='readOnlyCell' title="{{dataItem.ECAP_PRC}}">
                                                ${{dataItem.ECAP_PRC}}
                                            </div>
                                        </ng-template>
                                    </ng-template>
                                </kendo-grid-column>
                                <kendo-grid-column field="YCS2" title="YCS2 Price" width="120" [headerClass]="{'headerClass':true}">
                                    <ng-template kendoGridFilterMenuTemplate let-column="column" let-filter="filter" let-filterService="filterService">
                                        <multicheck-filter class="meet-comp-filter" [isPrimitive]="true" [field]="column.field" [currentFilter]="filter" [filterService]="filterService" [data]="distinctPrimitiveChild(column.field)">
                                        </multicheck-filter>
                                    </ng-template>
                                    <ng-template kendoGridCellTemplate let-dataItem>
                                        <div *ngIf="dataItem.YCS2==0;else ycs2_prc" class='readOnlyCell' title="0">
                                        </div>
                                        <ng-template #ycs2_prc>
                                            <div class='readOnlyCell' title="{{dataItem.YCS2}}">
                                                ${{dataItem.YCS2}}
                                            </div>
                                        </ng-template>
                                    </ng-template>
                                </kendo-grid-column>
                            </kendo-grid>
                            <!-- CHILD GRID ENDS -->
                        </div>
                    </ng-template>
                </kendo-grid>
            </div>
            <div id="isGridEditable" value=false></div>
        </div>
    </div>
    <kendo-dialog *ngIf="showPopup" (close)="closePopup()" [width]="1150" class="indicate-dialog">
        <div class="kendoAlert">{{popUpMessage}}</div>
        <kendo-dialog-actions class="dialog-action">
            <div (click)="savePopupAction()" class="primary-btn">OK</div>
            <div (click)="closePopup()" class="secondary-btn">CANCEL</div>
        </kendo-dialog-actions>
    </kendo-dialog>
</div>
<kendo-dialog *ngIf="showEmptyDataAlert" (close)="closeEmptyDataPopup()" [width]="700" class="noMCPopup">
    <div class="noMCAlert">{{emptyDataAlertMsg}}</div>
    <kendo-dialog-actions class="noMCAction">
        <button (click)="closeEmptyDataPopup()" class="noMCok" kendoButton>OK</button>
    </kendo-dialog-actions>
</kendo-dialog>