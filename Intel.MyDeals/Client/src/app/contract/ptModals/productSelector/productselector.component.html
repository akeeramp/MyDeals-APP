<div class="product-selector modal-content productSelectorParent">
    <div class="prodSelector modal-header header-PS">
        <div class="row" style="width:100%">
            <div class="col-md-4 col-sm-4 col-xs-4">
                <p class="prodHeader cursorArea" style="margin-left:8px">
                    Product Selector
                    <img *ngIf="isLoadingSearchProducts" src="/Images/loadingSmall.gif" alt="loader image" style="margin-left: 25px" />
                </p>
            </div>
            <div class="col-md-8 col-sm-8 col-xs-8 prodSelectorSearch">
                <div class="modalCloseIcon fr">
                    <i role="button" title="Close" class="intelicon-close-max" style="position:relative" (click)="cancel()"></i>
                </div>
                <button class="btn btn-default prdBtn fr" (click)="clearSearch()" style="margin: 0 0 0 8px;">
                    Clear
                </button>
                <button class="btn btn-primary prdBtn fr" (click)="searchProduct()" style="margin: 0 0 0 10px;">
                    Search
                </button>
                <kendo-autocomplete id="productSearch" class="prod-autocomplete fr form-control input-sm" [(ngModel)]="userInput" [suggest]="false" [data]="productOptions" [filterable]="true" (filterChange)="changeProductOption($event)" (keyup)="textChange($event)"
                    valueField="Name">
                </kendo-autocomplete>
            </div>
        </div>

        <!-- kendo breadcrumb implementation this is not exact breadcrumb but making in the similar way -->
        <div class="row breadCrumbWrapper" style="width: 100%;">
            <div class="col-md-12">
                <ul class="productSelectorpath breadcrumb">
                    <li><a class="prdAnchor" (click)="selectPath(0)">{{drillDownPrd}}</a></li>
                    <ng-container *ngFor="let p of selectedPathParts | unique:'name'; let index=index">
                        <li *ngIf="p.name != 'NA' || p.path.startsWith('CPU SvrWS NA')"><a class="prdAnchor" (click)="selectPath(index + 1)">{{p.name}}</a></li>
                    </ng-container>
                </ul>
            </div>
        </div>
    </div>
    <div style="">
        <div class="prodSelector modal-body prodFull-height-fix">
            <div *ngIf="showSuggestions" class="productSelector subHeaderNavContainer mini-right miniProdNav">
                <div *ngIf="!(errorMessage.length > 0)" style="height: calc(100% - 25px);">
                    <div *ngIf="!disableSelection">{{suggestionText}}</div>
                    <div class="productSelector Issue" *ngIf="disableSelection">Product(s) does not match the global filter criteria (Media Code in Autofill defaults for instance) or is not active within the deal date range.</div>
                    <div style="padding-top:5px;" id="prodGrid" class="declaringProdGrid">
                        <table *ngIf="suggestedProducts.length !== 0" style="width: 100%; height: 100%;table-layout:fixed">
                            <tr>
                                <td style="width:20%;min-width:20px;max-width:200px">
                                    <div class="leftNavFilter">
                                        <div class="row">
                                            <div class="col">
                                                <p class='filterTitleUnderline' *ngIf="curRowIssues.length > 0">Products Found</p>
                                                <kendo-treeview class="lblFilterProd" [nodes]="curRowIssues" [(selectedKeys)]="selRowIssuesKeys" textField="name" [hasChildren]="false" selectBy="value" [kendoTreeViewSelectable]="selection" (selectedKeysChange)="onPrdChange($event,'USR_INPUT')">
                                                    <ng-template kendoTreeViewNodeTemplate let-dataItem>
                                                        {{dataItem.name }}
                                                        <span class="badge upperBadge"> {{dataItem.cnt == 0 ? "?" : dataItem.cnt }}</span>
                                                    </ng-template>
                                                </kendo-treeview>
                                            </div>
                                        </div>
                                        <div class="row" *ngIf="curRowLvl.length>1">
                                            <div class="col">
                                                <p class="filterTitleUnderline">Product Level</p>
                                                <kendo-treeview class="lblFilterProd" [nodes]="curRowLvl" [(selectedKeys)]="selPrdLvlKeys" textField="name" [hasChildren]="false" selectBy="value" [kendoTreeViewSelectable]="selection" (selectedKeysChange)="onPrdChange($event,'PRD_ATRB_SID')">
                                                </kendo-treeview>
                                            </div>
                                        </div>
                                        <div class="row" *ngIf="curRowCategories.length>1">
                                            <div class="col">
                                                <p class="filterTitleUnderline">Product Vertical</p>
                                                <kendo-treeview class="lblFilterProd" [nodes]="curRowCategories" [(selectedKeys)]="selPrdVerKeys" textField="name" [hasChildren]="false" selectBy="value" [kendoTreeViewSelectable]="selection" (selectedKeysChange)="onPrdChange($event,'PRD_CAT_NM')">
                                                </kendo-treeview>
                                            </div>
                                        </div>
                                    </div>
                                </td>
                                <td class="new-now-wrap oppo-grids">
                                    <kendo-grid class="select-suggest-pop-up" [data]="filteredGridData" [loading]="isfilteredGridLoading" [pageSize]="filteredState.take" [skip]="filteredState.skip" [filter]="filteredState.filter" filterable="menu" [sortable]="true" [sort]="filteredState.sort" [pageable]="{type:type,pageSizes: pageSizes,info:info,refresh:true}"
                                        [groupable]="false" [group]="filteredState.group" [resizable]="true" (dataStateChange)="(dataStateChange)($event,'filter')">
                                        <kendo-grid-column width="65px" [columnMenu]="false">
                                            <ng-template kendoGridHeaderTemplate let-column let-columnIndex="columnIndex">
                                                <div class='dealTools check-center'>
                                                    <input type='checkbox' class='grid-link-checkbox with-font th-check-box' (click)="toggleSelectAll($event, suggestedProducts)">
                                                </div>
                                            </ng-template>
                                            <ng-template kendoGridCellTemplate let-dataItem>
                                                <div class='dealTools check-center'>
                                                    <input type='checkbox' class='grid-link-checkbox with-font th-check-box' (click)="toggleSelect(dataItem)" [(ngModel)]="dataItem.selected">
                                                </div>
                                            </ng-template>
                                        </kendo-grid-column>
                                        <ng-template ngFor [ngForOf]="gridColumnsSuggestion" let-column>
                                            <kendo-grid-column [headerClass]="{ 'headerClass': true }" field="{{ column.field }}" title="{{ column.title }}" [hidden]="column.hidden" [width]="column.width" [style]="{'white-space': 'nowrap'}">
                                                <div *ngIf="column.field !== 'EPM_NM' && column.field !=='PRD_STRT_DTM' && column.field !== 'PRD_END_DTM'">
                                                    <ng-template kendoGridFilterMenuTemplate let-column="column" let-filter="filter"
                                                                 let-filterService="filterService">
                                                        <multicheck-filter [isPrimitive]="true" [field]="column.field" [currentFilter]="filter"
                                                                           [filterService]="filterService" [data]="distinctPrimitive(column.field,'filter')"></multicheck-filter>
                                                    </ng-template>
                                                </div>
                                                <!-- Template for `Cap Info` column -->
                                                <div *ngIf="column.field == 'CAP'">
                                                    <ng-template kendoGridCellTemplate let-dataItem >
                                                        <!-- Popover Template -->
                                                        <ng-template #popoverContent>
                                                            <div class="popover-content " >
                                                                <div class="row">
                                                                    <a id="closePopoverSelector" role="button" (click)="popOver.close()"><i class="intelicon-close-max"></i></a>
                                                                </div>
                                                                <div class="row">
                                                                    <grid-popover [popOver]="popOver" [columnTypes]="column.field" [currentPricingTableRow]="pricingTableRow" [productMemberSId]="dataItem.PRD_MBR_SID" [priceCondition]="column.field"></grid-popover>
                                                                </div>
                                                            </div>
                                                        </ng-template>

                                                        <!-- Cell Content -->
                                                        <div class="CAPYCS2CellContent" #popOver="ngbPopover" [ngbPopover]="popoverContent"  (click)="openCAPBreakOut(dataItem, 'CAP')">
                                                            <!-- CAP Info cell design -->
                                                            <div [class.isSoftWarnCell]="dataItem.CAP.includes('No')" style="text-align: center;">
                                                                <span *ngIf="dataItem.CAP != undefined && dataItem.CAP != null && dataItem.CAP !='' && dataItem.CAP !='No CAP'">
                                                                    <strong>{{dataItem.CAP | currency}}</strong>
                                                                </span>
                                                                <span *ngIf="dataItem.CAP != undefined && dataItem.CAP != null && dataItem.CAP ==='No CAP'">
                                                                    {{dataItem.CAP}}
                                                                </span>
                                                                <div *ngIf="!dataItem.CAP.includes('No')">
                                                                    <br /> {{ dataItem.CAP_START }} - {{ dataItem.CAP_END }}
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </ng-template>
                                                </div>
                                                <!-- Template for `YCS2 Info` column -->
                                                <div *ngIf="column.field == 'YCS2'">
                                                    <ng-template kendoGridCellTemplate let-dataItem>
                                                        <!--Cell Content-->
                                                        <div class="CAPYCS2CellContent" (click)="openCAPBreakOut(dataItem, 'YCS2')">
                                                            <!--YCS2 Info cell design-->
                                                            <div [class.isSoftWarnCell]="dataItem.YCS2.includes('No')" style="text-align: center;">
                                                                {{ dataItem.YCS2 }}
                                                            </div>
                                                        </div>
                                                    </ng-template>
                                                </div>
                                                <div *ngIf="column.field == 'EPM_NM' || column.field == 'SKU_NM'">
                                                    <ng-template kendoGridCellTemplate let-dataItem>
                                                        <div kendoTooltip position="bottom">
                                                            <span title="{{dataItem.EPM_NM}}">{{dataItem.EPM_NM}}</span>
                                                        </div>
                                                    </ng-template>
                                                </div>
                                                <div *ngIf="column.title == 'Product Effective Date'">
                                                    <ng-template kendoGridCellTemplate let-dataItem>
                                                        <div>{{dataItem.PRD_STRT_DTM | date: 'M/d/yyyy'}} - {{dataItem.PRD_END_DTM | date: 'M/d/yyyy'}}</div>
                                                    </ng-template>
                                                </div>
                                            </kendo-grid-column>
                                        </ng-template>
                                    </kendo-grid>
                                </td>
                            </tr>
                        </table>
                        <div class="productSelector Warning" *ngIf="suggestedProducts.length === 0">
                            Unable to find any products for "{{userInput}}."
                        </div>
                    </div>
                </div>
                <div class="productSelector Issue" *ngIf="errorMessage.length > 0">
                    {{errorMessage}}
                </div>
            </div>
            <div *ngIf="showTree && !showSuggestions" id="prodGrid" class="prodSelector opUiContainer md prodSelector-grid k-grid kendoGridHeight">
                <kendo-grid class="raid-style proselector-raid-style" [data]="gridData" [loading]="isGridLoading" [pageSize]="state.take" [skip]="state.skip" [filter]="state.filter" filterable="menu" [sortable]="true" [sort]="state.sort" [pageable]="{type:type,pageSizes: pageSizes,info:info,refresh:true}"
                    [groupable]="false" [resizable]="true" (dataStateChange)="dataStateChange($event)">
                    <kendo-grid-column width="65px" [columnMenu]="false">
                        <ng-template kendoGridHeaderTemplate let-column let-columnIndex="columnIndex">
                            <div class='dealTools all-checkbox-center'>
                                <input type='checkbox' class='grid-link-checkbox with-font th-check-box' (click)="toggleSelectAll($event, gridFullData)">
                            </div>
                        </ng-template>
                        <ng-template kendoGridCellTemplate let-dataItem>
                            <div class='dealTools all-checkbox-center'>
                                <input type='checkbox' class='grid-link-checkbox with-font th-check-box' (click)="selectProduct(dataItem)" [(ngModel)]="dataItem.selected">
                            </div>
                        </ng-template>
                    </kendo-grid-column>
                    <ng-template ngFor [ngForOf]="gridColumnsProduct" let-column>
                        <kendo-grid-column [headerClass]="{ 'headerClass': true }" field="{{ column.field }}" title="{{ column.title }}" [hidden]="column.hidden" [width]="column.width">
                            <div *ngIf="column.field !== 'EPM_NM' && column.field !=='PRD_STRT_DTM' && column.field !== 'PRD_END_DTM'">
                                <ng-template kendoGridFilterMenuTemplate let-column="column" let-filter="filter"
                                             let-filterService="filterService">
                                    <multicheck-filter [isPrimitive]="true" [field]="column.field" [currentFilter]="filter"
                                                       [filterService]="filterService" [data]="distinctPrimitive(column.field)"></multicheck-filter>
                                </ng-template>
                            </div>
                            <!-- Link for processor number -->
                            <div *ngIf="column.field == 'PCSR_NBR'">
                                <ng-template kendoGridCellTemplate let-dataItem>
                                    <a *ngIf='dataItem.PRD_ATRB_SID == 7006' (click)='gridSelectItem(dataItem)'>{{dataItem.PCSR_NBR}}</a>
                                    <div *ngIf='dataItem.PRD_ATRB_SID != 7006'>{{dataItem.PCSR_NBR}}</div>
                                </ng-template>
                            </div>
                            <!-- Link for deal product name -->
                            <div *ngIf="column.field == 'DEAL_PRD_NM'">
                                <ng-template kendoGridCellTemplate let-dataItem>
                                    <a *ngIf='allowMMSelection(dataItem)' (click)='gridSelectItem(dataItem)'>{{dataItem.DEAL_PRD_NM}}</a>
                                    <div *ngIf='!allowMMSelection(dataItem)'>{{dataItem.DEAL_PRD_NM}}</div>
                                </ng-template>
                            </div>
                            <div *ngIf="column.field == 'PCSR_NBR'">
                                <ng-template kendoGridCellTemplate let-dataItem>
                                    <a *ngIf='dataItem.PRD_ATRB_SID == 7006' (click)='gridSelectItem(dataItem)'>{{dataItem.PCSR_NBR}}</a>
                                    <div *ngIf='dataItem.PRD_ATRB_SID != 7006'>{{dataItem.PCSR_NBR}}</div>
                                </ng-template>
                            </div>
                            <!-- Template for `Cap Info` column -->
                            <div *ngIf="column.field == 'CAP'" >
                                <ng-template kendoGridCellTemplate let-dataItem >
                                    <!-- Popover Template -->
                                    <ng-template #popoverContent>
                                        <div class="popover-content product_selector_m">
                                            <div class="row" style="flex-direction:row-reverse">
                                                <a id="closePopoverSelector" role="button" (click)="popOver.close()"><i class="intelicon-close-max"></i></a>
                                            </div>
                                            <div class="row">
                                                <grid-popover [popOver]="popOver" [columnTypes]="column.field" [currentPricingTableRow]="pricingTableRow" [productMemberSId]="dataItem.PRD_MBR_SID" [priceCondition]="column.field"></grid-popover>
                                            </div>
                                        </div>
                                    </ng-template>

                                    <!-- Cell Content -->
                                    <div class="CAPYCS2CellContent accurate-height" #popOver="ngbPopover" [ngbPopover]="popoverContent" style="padding:0 !important"  (click)="openCAPBreakOut(dataItem, 'CAP')">
                                        <!-- CAP Info cell design -->
                                        <div [class.isSoftWarnCell]="dataItem.CAP.includes('No')" [class.uiControlDiv]="dataItem.CAP.includes('No')" style="text-align: center;">
                                            <span *ngIf="dataItem.CAP != undefined && dataItem.CAP != null && dataItem.CAP !='' && dataItem.CAP !='No CAP'">
                                                <strong>{{dataItem.CAP | currency}}</strong>
                                            </span>
                                            <span *ngIf="dataItem.CAP != undefined && dataItem.CAP != null && dataItem.CAP ==='No CAP'">
                                                {{dataItem.CAP}}
                                            </span>
                                            <div class="another-possible" *ngIf="!dataItem.CAP.includes('No')">
                                                {{ dataItem.CAP_START }} - {{ dataItem.CAP_END }}
                                            </div>
                                        </div>
                                    </div>
                                </ng-template>
                            </div>
                            <!-- Template for `YCS2 Info` column -->
                            <div *ngIf="column.field == 'YCS2'">
                                <ng-template kendoGridCellTemplate let-dataItem>
                                    <!-- Cell Content -->
                                    <div class="CAPYCS2CellContent bg-yellow-remove" (click)="openCAPBreakOut(dataItem, 'YCS2')">
                                        <!-- YCS2 Info cell design -->
                                        <div [class.isSoftWarnCell]="dataItem.YCS2.includes('No')" [class.uiControlDiv]="dataItem.YCS2.includes('No')" class="product-selector-font-align">
                                            {{ dataItem.YCS2 }}
                                        </div>
                                    </div>
                                </ng-template>
                            </div>
                            <div *ngIf="column.field == 'EPM_NM' || column.field == 'SKU_NM'">
                                <ng-template kendoGridCellTemplate let-dataItem>
                                    <div kendoTooltip position="left" [tooltipWidth]="263">
                                        <span title="{{dataItem.EPM_NM}}">{{dataItem.EPM_NM}}</span>
                                    </div>
                                </ng-template>
                            </div>
                        </kendo-grid-column>
                    </ng-template>
                </kendo-grid>
            </div>
            <div *ngIf="!showTree && !showSuggestions">
                <div *ngIf="!hideSelection">
                    <div *ngIf="displayTemplateType == 'btnGroup' && items.length == 1" class="row" style="padding-left: 10px; padding-right: 10px; font-size: 16px;">
                        <div class="drillDown btn-group btn-group-justified">
                            <ng-container class="btn-group" *ngFor="let p of items; let last=last; let index=index">
                                <div [ngClass]="{'input-group_1':p.allowMultiple}" class="col-md-12">
                                    <span *ngIf="p.allowMultiple" [ngClass]="{'input-group-addon':p.allowMultiple}" class="col-md-1">
                                        <input id="{{p.name}}" class="check with-sm-font" (click)="selectProduct(p,$event)" [(ngModel)]="p.selected" type="checkbox">
                                        <label style="margin-bottom:0px;" for="{{p.name}}"></label>
                                    </span>
                                    <button *ngIf="!(selectedPathParts.length < 2)" title="{{p.name}}"
                                            type="button" [ngClass]="{'col-md-12': !(p.allowMultiple)}" (click)="selectItem(p, true)" class="btn btn-default noborder col-md-11">
                                        {{checkForBlank(p.name)}}
                                    </button>
                                    <button *ngIf="(selectedPathParts.length < 2)" kendo-tooltip k-content="getVerticalsUnderMarkLevel(p.name)"
                                            type="button" [ngClass]="{'col-md-12': !(p.allowMultiple)}" (click)="selectItem(p, true)" class="btn btn-default noborder col-md-11">
                                        {{checkForBlank(p.name)}}
                                    </button>
                                </div>
                            </ng-container>
                        </div>
                    </div>
                    <div *ngIf="displayTemplateType == 'btnGroup' && items.length == 2" class="row" style="padding-left: 10px; padding-right: 10px; font-size: 16px;">
                        <div class="drillDown btn-group btn-group-justified col-md-12">
                            <ng-container class="btn-group" *ngFor="let p of items; let last=last; let index=index">
                                <div class="col-md-6">
                                    <span *ngIf="p.allowMultiple" [ngClass]="{'input-group-addon':p.allowMultiple}" class="col-md-1">
                                        <input id="{{p.name}}" class="check with-sm-font" (click)="selectProduct(p,$event)" [(ngModel)]="p.selected" type="checkbox">
                                        <label style="margin-bottom:0px;" for="{{p.name}}"></label>
                                    </span>
                                    <button *ngIf="!(selectedPathParts.length < 2)" title="{{p.name}}"
                                            type="button" [ngClass]="{'noborder':(index == 1), 'col-md-12': !(p.allowMultiple)}" (click)="selectItem(p, true)" class="btn btn-default col-md-11">
                                        {{checkForBlank(p.name)}}
                                    </button>
                                    <button *ngIf="(selectedPathParts.length < 2)" kendo-tooltip k-content="getVerticalsUnderMarkLevel(p.name)"
                                            type="button" [ngClass]="{'noborder':(index == 1), 'col-md-12': !(p.allowMultiple)}" (click)="selectItem(p, true)" class="btn btn-default col-md-11">
                                        {{checkForBlank(p.name)}}
                                    </button>
                                </div>
                            </ng-container>
                        </div>
                    </div>
                    <div *ngIf="displayTemplateType == 'btnGroup' && items.length == 3" class="row" style="padding-left: 10px; padding-right: 10px; font-size: 16px;">
                        <div class="drillDown btn-group btn-group-justified col-md-12">
                            <ng-container class="btn-group" *ngFor="let p of items; let last=last; let index=index">
                                <div class="col-md-4">
                                    <span *ngIf="p.allowMultiple" [ngClass]="{'input-group-addon':p.allowMultiple}" class="col-md-1" style="z-index:1">
                                        <input id="{{p.name}}" class="check with-sm-font" (click)="selectProduct(p,$event)" [(ngModel)]="p.selected" type="checkbox">
                                        <label style="margin-bottom:0px;" for="{{p.name}}"></label>
                                    </span>
                                    <button *ngIf="!(selectedPathParts.length < 2)" title="{{p.name}}"
                                            type="button" [ngClass]="{'noborder':(index == 2), 'col-md-12': !(p.allowMultiple)}" (click)="selectItem(p, true)" class="btn btn-default col-md-11">
                                        {{checkForBlank(p.name)}}
                                    </button>
                                    <button *ngIf="(selectedPathParts.length < 2)" kendo-tooltip k-content="getVerticalsUnderMarkLevel(p.name)"
                                            type="button" [ngClass]="{'noborder':(index == 2), 'col-md-12': !(p.allowMultiple)}" (click)="selectItem(p, true)" class="btn btn-default col-md-11">
                                        {{checkForBlank(p.name)}}
                                    </button>
                                </div>
                            </ng-container>
                        </div>
                    </div>
                    <div *ngIf="displayTemplateType == 'btnGroup' && items.length == 4" class="row" style="padding-left: 10px; padding-right: 10px; font-size: 16px;">
                        <div class="drillDown btn-group btn-group-justified col-md-12">
                            <ng-container class="btn-group" *ngFor="let p of items; let last=last; let index=index">
                                <div class="col-md-3">
                                    <span *ngIf="p.allowMultiple" [ngClass]="{'input-group-addon':p.allowMultiple}" class="col-md-1" style="z-index:2">
                                        <input id="{{p.name}}" class="check with-sm-font" (click)="selectProduct(p,$event)" [(ngModel)]="p.selected" type="checkbox">
                                        <label style="margin-bottom:0px;" for="{{p.name}}"></label>
                                    </span>
                                    <button *ngIf="!(selectedPathParts.length < 2)" title="{{p.name}}"
                                            type="button" [ngClass]="{'noborder':(index == 3), 'col-md-12': !(p.allowMultiple)}" (click)="selectItem(p, true)" class="btn btn-default col-md-11">
                                        {{checkForBlank(p.name)}}
                                    </button>
                                    <button *ngIf="(selectedPathParts.length < 2)" kendo-tooltip k-content="getVerticalsUnderMarkLevel(p.name)"
                                            type="button" [ngClass]="{'noborder':(index == 3), 'col-md-12': !(p.allowMultiple)}" (click)="selectItem(p, true)" class="btn btn-default col-md-11">
                                        {{checkForBlank(p.name)}}
                                    </button>
                                </div>
                            </ng-container>
                        </div>
                    </div>
                    <div *ngIf="displayTemplateType == 'btnGroup' && items.length == 5" class="row" style="padding-left: 10px; padding-right: 10px; font-size: 16px;">
                        <div class="drillDown btn-group btn-group-justified col-md-12">
                            <ng-container class="btn-group" *ngFor="let p of items; let last=last; let index=index">
                                <div style="width:20%">
                                    <span *ngIf="p.allowMultiple" [ngClass]="{'input-group-addon':p.allowMultiple}" class="col-md-1" style="z-index:5">
                                        <input id="{{p.name}}" class="check with-sm-font" (click)="selectProduct(p,$event)" [(ngModel)]="p.selected" type="checkbox">
                                        <label style="margin-bottom:0px;" for="{{p.name}}"></label>
                                    </span>
                                    <button *ngIf="!(selectedPathParts.length < 2)" title="{{p.name}}"
                                            type="button" [ngClass]="{'noborder':(index == 4), 'col-md-12': !(p.allowMultiple)}" (click)="selectItem(p, true)" class="btn btn-default col-md-11">
                                        {{checkForBlank(p.name)}}
                                    </button>
                                    <button *ngIf="(selectedPathParts.length < 2)" kendo-tooltip k-content="getVerticalsUnderMarkLevel(p.name)"
                                            type="button" [ngClass]="{'noborder':(index == 4), 'col-md-12': !(p.allowMultiple)}" (click)="selectItem(p, true)" class="btn btn-default col-md-11">
                                        {{checkForBlank(p.name)}}
                                    </button>
                                </div>
                            </ng-container>
                        </div>
                    </div>
                    <div *ngIf="displayTemplateType == 'btnGroup' && items.length == 6" class="row" style="padding-left: 10px; padding-right: 10px; font-size: 16px;">
                        <div class="drillDown btn-group btn-group-justified col-md-12">
                            <ng-container class="btn-group" *ngFor="let p of items; let last=last; let index=index">
                                <div class="col-md-2">
                                    <span *ngIf="p.allowMultiple" [ngClass]="{'input-group-addon':p.allowMultiple}" class="col-md-1" style="z-index:5">
                                        <input id="{{p.name}}" class="check with-sm-font" (click)="selectProduct(p,$event)" [(ngModel)]="p.selected" type="checkbox">
                                        <label style="margin-bottom:0px;" for="{{p.name}}"></label>
                                    </span>
                                    <button *ngIf="!(selectedPathParts.length < 2)" title="{{p.name}}"
                                            type="button" [ngClass]="{'noborder':(index == 5), 'col-md-12': !(p.allowMultiple)}" (click)="selectItem(p, true)" class="btn btn-default col-md-11">
                                        {{checkForBlank(p.name)}}
                                    </button>
                                    <button *ngIf="(selectedPathParts.length < 2)" kendo-tooltip k-content="getVerticalsUnderMarkLevel(p.name)"
                                            type="button" [ngClass]="{'noborder':(index == 5), 'col-md-12': !(p.allowMultiple)}" (click)="selectItem(p, true)" class="btn btn-default col-md-11">
                                        {{checkForBlank(p.name)}}
                                    </button>
                                </div>
                            </ng-container>
                        </div>
                    </div>
                    <div *ngIf="displayTemplateType == 'btnGroup' && items.length == 7" class="row" style="padding-left: 10px; padding-right: 10px; font-size: 16px;">
                        <div class="drillDown btn-group btn-group-justified col-md-12">
                            <ng-container class="btn-group" *ngFor="let p of items; let last=last; let index=index">
                                <div style="width:14.29%">
                                    <span *ngIf="p.allowMultiple" [ngClass]="{'input-group-addon':p.allowMultiple}" class="col-md-1" style="z-index:5">
                                        <input id="{{p.name}}" class="check with-sm-font" (click)="selectProduct(p,$event)" [(ngModel)]="p.selected" type="checkbox">
                                        <label style="margin-bottom:0px;" for="{{p.name}}"></label>
                                    </span>
                                    <button *ngIf="!(selectedPathParts.length < 2)" title="{{p.name}}"
                                            type="button" [ngClass]="{'noborder':(index == 6), 'col-md-12': !(p.allowMultiple)}" (click)="selectItem(p, true)" class="btn btn-default col-md-11">
                                        {{checkForBlank(p.name)}}
                                    </button>
                                    <button *ngIf="(selectedPathParts.length < 2)" kendo-tooltip k-content="getVerticalsUnderMarkLevel(p.name)"
                                            type="button" [ngClass]="{'noborder':(index == 6), 'col-md-12': !(p.allowMultiple)}" (click)="selectItem(p, true)" class="btn btn-default col-md-11">
                                        {{checkForBlank(p.name)}}
                                    </button>
                                </div>
                            </ng-container>
                        </div>
                    </div>
                    <div *ngIf="displayTemplateType == 'btnGrid'" class="row" style="margin:2px;">
                        <ng-container *ngFor="let p of items; let last=last; let index=index">
                            <div class="clearfix" *ngIf="index % 4 == 0"></div>
                            <div kendoTooltip position="bottom" class="col-sm-3 prodDrillDownLarge" title="{{checkTitle(p.name)}}" [ngClass]="{'noLeftBorder':index % 4 == 0}">
                                <div [ngClass]="{'input-group':p.allowMultiple}" class="drillDown">
                                    <span *ngIf="p.allowMultiple" [ngClass]="{'input-group-addon':p.allowMultiple}">
                                        <input id="{{p.name}}" class="check with-sm-font" (click)="selectProduct(p)" [(ngModel)]="p.selected" type="checkbox">
                                        <label style="margin-bottom:0px;" for="{{p.name}}"></label>
                                    </span>
                                    <p role="button" (click)="selectItem(p, true)">{{checkForBlank(p.name)}}</p>
                                </div>
                            </div>
                        </ng-container>
                    </div>
                </div>
                <div *ngIf="hideSelection">
                    <div class="row" *ngIf="searchItems.length > 0" style="padding-left:10px;padding-right:10px;font-size:16px;">
                        <div class="drillDown btn-group btn-group-justified prod-sel-btn" role="group" aria-label="...">
                            <ng-container class="btn-group" *ngFor="let p of searchItems | orderBy:'name'; let last=last " role="group">
                                <button type="button" title="{{p.name}}" [ngClass]="{'noborder':last}" (click)="selectsearchItem(p)" class="btn btn-default">{{p.name}}</button>
                            </ng-container>
                        </div>
                    </div>
                    <div *ngIf="showSearchResults" id="prodGrid" class="prodSelector opUiContainer md prodSelector-grid k-grid kendoGridHeight">
                        <kendo-grid class="raid-style" [data]="gridData" [loading]="isGridLoading" [pageSize]="state.take" [skip]="state.skip" [filter]="state.filter" filterable="menu" [sortable]="true" [sort]="state.sort" [pageable]="{type:type,pageSizes: pageSizes,info:info,refresh:true}" [groupable]="false"
                            [resizable]="true" (dataStateChange)="dataStateChange($event)">
                            <kendo-grid-column width="65px" [columnMenu]="false">
                                <ng-template kendoGridHeaderTemplate let-column let-columnIndex="columnIndex">
                                    <div class='dealTools check-center'>
                                        <input type='checkbox' class='grid-link-checkbox with-font th-check-box' (click)="toggleSelectAll($event)">
                                    </div>
                                </ng-template>
                                <ng-template kendoGridCellTemplate let-dataItem>
                                    <div class='dealTools check-center'>
                                        <input type='checkbox' class='grid-link-checkbox with-font th-check-box' (click)="selectProduct(dataItem)" [(ngModel)]="dataItem.selected">
                                    </div>
                                </ng-template>
                            </kendo-grid-column>
                            <ng-template ngFor [ngForOf]="gridColumnsProduct" let-column>
                                <kendo-grid-column [headerClass]="{ 'headerClass': true }" field="{{ column.field }}" title="{{ column.title }}" [hidden]="column.hidden" [width]="column.width">
                                    <div *ngIf="column.field !== 'EPM_NM' && column.field !=='PRD_STRT_DTM' && column.field !== 'PRD_END_DTM'">
                                        <ng-template kendoGridFilterMenuTemplate let-column="column" let-filter="filter"
                                                     let-filterService="filterService">
                                            <multicheck-filter [isPrimitive]="true" [field]="column.field" [currentFilter]="filter"
                                                               [filterService]="filterService" [data]="distinctPrimitive(column.field)"></multicheck-filter>
                                        </ng-template>
                                    </div>
                                    <!-- Link for processor number -->
                                    <div *ngIf="column.field == 'PCSR_NBR'">
                                        <ng-template kendoGridCellTemplate let-dataItem>
                                            <a *ngIf='dataItem.PRD_ATRB_SID == 7006' (click)='gridSelectItem(dataItem)'>{{dataItem.PCSR_NBR}}</a>
                                            <div *ngIf='dataItem.PRD_ATRB_SID != 7006'>{{dataItem.PCSR_NBR}}</div>
                                        </ng-template>
                                    </div>
                                    <!-- Link for deal product name -->
                                    <div *ngIf="column.field == 'DEAL_PRD_NM'">
                                        <ng-template kendoGridCellTemplate let-dataItem>
                                            <a *ngIf='allowMMSelection(dataItem)' (click)='gridSelectItem(dataItem)'>{{dataItem.DEAL_PRD_NM}}</a>
                                            <div *ngIf='!allowMMSelection(dataItem)'>{{dataItem.DEAL_PRD_NM}}</div>
                                        </ng-template>
                                    </div>
                                    <div *ngIf="column.field == 'PCSR_NBR'">
                                        <ng-template kendoGridCellTemplate let-dataItem>
                                            <a *ngIf='dataItem.PRD_ATRB_SID == 7006' (click)='gridSelectItem(dataItem)'>{{dataItem.PCSR_NBR}}</a>
                                            <div *ngIf='dataItem.PRD_ATRB_SID != 7006'>{{dataItem.PCSR_NBR}}</div>
                                        </ng-template>
                                    </div>
                                    <!-- Template for `Cap Info` column -->
                                    <div *ngIf="column.field == 'CAP'" >
                                        <ng-template kendoGridCellTemplate let-dataItem>
                                            <!-- Popover Template -->
                                            <ng-template #popoverContent>
                                                <div class="popover-content product_selector_m">
                                                    <div class="row" style="flex-direction:row-reverse">
                                                        <a id="closePopoverSelector" role="button" (click)="popOver.close()"><i class="intelicon-close-max"></i></a>
                                                    </div>
                                                    <div class="row">
                                                        <grid-popover [popOver]="popOver" [columnTypes]="column.field" [currentPricingTableRow]="pricingTableRow" [productMemberSId]="dataItem.PRD_MBR_SID" [priceCondition]="column.field"></grid-popover>
                                                    </div>
                                                </div>
                                            </ng-template>

                                            <!-- Cell Content -->
                                            <div class="CAPYCS2CellContent" #popOver="ngbPopover" [ngbPopover]="popoverContent" (click)="openCAPBreakOut(dataItem, 'CAP')">
                                                <!-- CAP Info cell design -->
                                                <div [class.isSoftWarnCell]="dataItem.CAP.includes('No')" style="text-align: center;">
                                                    <span *ngIf="dataItem.CAP != undefined && dataItem.CAP != null && dataItem.CAP !='' && dataItem.CAP !='No CAP'">
                                                        <strong>{{dataItem.CAP | currency}}</strong>
                                                    </span>
                                                    <span *ngIf="dataItem.CAP != undefined && dataItem.CAP != null && dataItem.CAP ==='No CAP'">
                                                        {{dataItem.CAP}}
                                                    </span>
                                                    <div *ngIf="!dataItem.CAP.includes('No')"> {{ dataItem.CAP_START }} - {{ dataItem.CAP_END }}
                                                    </div>
                                                </div>
                                            </div>
                                        </ng-template>
                                    </div>
                                    <!-- Template for `YCS2 Info` column -->
                                    <div *ngIf="column.field == 'YCS2'">
                                        <ng-template kendoGridCellTemplate let-dataItem>
                                            <!-- Cell Content -->
                                            <div class="CAPYCS2CellContent bg-yellow-remove" (click)="openCAPBreakOut(dataItem, 'YCS2')">
                                                <!-- YCS2 Info cell design -->
                                                <div [class.isSoftWarnCell]="dataItem.YCS2.includes('No')" [class.uiControlDiv]="dataItem.YCS2.includes('No')" style="text-align: center;" class="product-selector-font-align">
                                                    {{ dataItem.YCS2 }}
                                                </div>
                                            </div>

                                        </ng-template>
                                    </div>
                                    <div *ngIf="column.field == 'EPM_NM' || column.field == 'SKU_NM'">
                                        <ng-template kendoGridCellTemplate let-dataItem>
                                            <div kendoTooltip position="bottom">
                                                <span title="{{dataItem.EPM_NM}}">{{dataItem.EPM_NM}}</span>
                                            </div>
                                        </ng-template>
                                    </div>
                                </kendo-grid-column>
                            </ng-template>
                        </kendo-grid>
                    </div>
                </div>
            </div>
        </div>
        <div class="prodSelector modal-footer ps-v-modal-footer">
            <div class="footerInline cus-them-padding">
                <div *ngIf="excludeMode">
                    <span>
                        <span class="text-left textProdSelector">
                            Excluded Products
                            <span class="arcAnimate">
                                <small role="button">&nbsp;({{excludedProducts.length}})</small>
                            </span>
                    </span>
                    </span>
                    <trashcan title="Clear excluded products" class="fr" (click)="clearProducts('E')"></trashcan>
                </div>
                <div *ngIf="!excludeMode" class="row">
                    <div [ngClass]="{'col-md-6':enableMultipleSelection, 'col-md-12': !enableMultipleSelection}" style="text-align: left; width: -webkit-fill-available;">
                        <span [ngClass]="{'paddingLeft15': !enableMultipleSelection}">
                            <span [ngClass]="{'paddingLeftNone':enableMultipleSelection}" class="text-left textProdSelector">
                                Selected Products
                                <span [ngClass]="{'animate':animateInclude}" class="arcAnimate ani-mate">
                                    <small role="button">&nbsp;({{addedProducts.length}})</small>
                                </span>
                            </span>
                        </span>
                        <trashcan title="Clear products" class="fr clear-shift-style" (click)="clearProducts()" [ngClass]="{'trash-margin': !enableMultipleSelection }"></trashcan>
                    </div>
                    <div *ngIf="enableMultipleSelection" class="col-md-6 multiple-selector">
                        <span>
                            <span class="paddingRightNone text-left textProdSelector">
                                Excluded Products
                                <span class="arcAnimate text-shift-left ani-mate" style="margin-right: 0 !important;">
                                    <small role="button">&nbsp;({{excludedProducts.length}})</small>
                                </span>
                            </span>
                        </span>
                        <trashcan title="Clear excluded products" class="fr" (click)="clearProducts('E')"></trashcan>
                    </div>
                </div>
                <div *ngIf="!excludeMode" class="row">
                    <div [ngClass]="{'col-md-6':enableMultipleSelection, 'paddingLeftNone':enableMultipleSelection, 'col-md-12':!enableMultipleSelection}">
                        <div contenteditable="false" class="prodSelected text-left" style="background-color:white; height:100px; width:100%; overflow:hidden auto; padding:5px;">
                            <span *ngFor="let item of addedProducts">
                                <span (click)="showSingleProductHierarchy(item)" class="product-list"
                                      [ngClass]="{'text-danger': isValidCapDetails(item),'product-selected-color':selectedProductcolor == item.HIER_NM_HASH}" title="{{isValidCapDetails(item, true)}}">
                                    {{item.HIER_VAL_NM}} &nbsp;
                                    <button (click)="removeProduct(item, 'add')" style="border:none;padding:0;height:0"> </button>
                                </span>
                            </span>
                        </div>
                    </div>
                    <div *ngIf="enableMultipleSelection" class="col-md-6 paddingRightNone">
                        <div contenteditable="false" class="prodSelected text-left" style="background-color: white; height: 100px; width: 100%; overflow: hidden auto; padding:5px;">
                            <span *ngFor="let item of excludedProducts">
                                <span class="product-list" [ngClass]="{'text-danger': isValidCapDetails(item)}" title="{{isValidCapDetails(item, true)}}">
                                    {{item.HIER_VAL_NM}}  &nbsp;
                                    <button (click)="removeProduct(item, 'exclude')" style="border:none;padding:0;height:0"> </button>
                                </span>
                            </span>
                        </div>
                    </div>
                </div>
                <div *ngIf="excludeMode" class="row" style="padding-left:15px;padding-right:15px;">
                    <div contenteditable="false" class="prodSelected text-left" style="background-color:white; height:100px; width:95%; overflow:scroll">
                        <span *ngFor="let item of excludedProducts">
                            <span class="product-list" [ngClass]="{'text-danger': isValidCapDetails(item)}" title="{{isValidCapDetails(item, true)}}">
                                {{item.HIER_VAL_NM}} &nbsp;
                                <button (click)="removeProduct(item, 'exclude')" style="border:none;padding:0;height:0"> </button>
                            </span>
                        </span>
                    </div>
                </div>
                <br />
                <div class="form-inline insertAtRowsText" style="margin-top:-30px;display:inline-block">
                    <span *ngIf="enableSplitProducts && this.data.source != 'Product Corrector' && (this.data.selVal==''|| this.data.selVal==null)">
                        <input id="separateProduct" class="checkbox-custom" [(ngModel)]="splitProducts" name="separateroducts" type="checkbox">
                        <label for="separateProduct" class="checkbox-custom-label label-allowers" style="padding-bottom:5px;margin-top:0px;">&nbsp;Separate product in rows</label>
                    </span>
                    <button class="btn btn-primary fr prdBtn disabled-save" [disabled]="!excludeMode && addedProducts.length == 0" (click)="save()">Save</button>
                    <button class="btn btn-default fr prdBtn" (click)="cancel()" style="margin-right:4px;">Cancel</button>
                </div>
            </div>
        </div>
    </div>
    <kendo-dialog class="fixing-product-kits" *ngIf="isAlert" (close)="closeDialog()" class="alterAlertMsg">
        <p  [innerHTML]="alertMsg" style="text-align: center; margin-bottom: 0;">
        </p>
        <kendo-dialog-actions style="padding: 0;">
            <button (click)="closeDialog()" class="btn-primary btnPrimes">OK</button>
        </kendo-dialog-actions>
    </kendo-dialog>
</div>