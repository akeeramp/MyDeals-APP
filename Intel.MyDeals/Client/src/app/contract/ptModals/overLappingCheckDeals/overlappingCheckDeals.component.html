<link href="/Client/node_modules/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet" />
<link href="/Client/node_modules/@progress/kendo-theme-bootstrap/dist/all.css" rel="stylesheet" />
<link href="/Client/node_modules/@angular/material/prebuilt-themes/indigo-pink.css" rel="stylesheet" />
<link href="/Client/src/app/admin/kendo_grid.css" rel="stylesheet" />

<!--<overlapping-deals></overlapping-deals>-->
<div id="overcheck" class="flex-container" style="display: flex; background-color: #0071C5">
    <p class="container" style="font-size:18px;color:#ffffff;margin:0px !important;padding:10px">Overlapping Deals</p>
    <button class="btn btn-sm ssToolbarBtn">
        <table>
            <tr>
                <td><i class="fa fa-window-minimize" style="font-size:13px;"></i></td>
            </tr>
        </table>
    </button>
    <button class="btn btn-sm ssToolbarBtn">
        <table>
            <tr>
                <td><i class="fa fa-window-maximize" style="font-size:13px;"></i></td>

            </tr>
        </table>
    </button>
    <button class="btn btn-sm ssToolbarBtn" (click)="closeWindow()">
        <table>
            <tr>
                <td><i class="intelicon-close" style="font-size: 17px;"></i></td>
            </tr>
        </table>
    </button>
</div>


<kendo-grid [data]="gridData" [loading]="isLoading" [pageSize]="state.take" [skip]="state.skip"
            [sort]="state.sort" [filter]="state.filter" [sortable]="true"
            [pageable]="{type:type,pageSizes: pageSizes,info:info,refresh:true}" [groupable]="false"
            [group]="state.group" filterable="menu" (dataStateChange)="dataStateChange($event)">
    <kendo-grid-column [headerClass]="{'headerClass':true}" field="WF_STG_CD" width="21px" title=" ">
    </kendo-grid-column>
    <kendo-grid-column field="PROGRAM_PAYMENT" width="120px" title="Type" [hidden]="true">
        <ng-template kendoGridGroupHeaderTemplate let-group let-field="field" let-value="value">
            <div *ngIf="value !== 'Frontend YCS2'"><span style='font-weight:bold;font-size:13px; color: red;letter-spacing:0.07em '>Billings Overlap</span></div>
            <div *ngIf="value == 'Frontend YCS2'">
                <span style='font-weight:bold;font-size:13px; color: red;letter-spacing:0.07em '>Front End Overlap</span>&nbsp;
                <button class='btn btn-sm btn-primary lnk btnSelect' *ngIf="isSelectAll" (click)="selectAllOvlp(true)">Select All</button>&nbsp;
                <button class='btn btn-sm btn-primary lnk btnSelect' *ngIf="!isSelectAll" (click)="selectAllOvlp(false)">Clear All</button>&nbsp;
                <button class='btn btn-sm  btn-primary lnk btnYes btnselectAccept' (click)="acceptSelectAll(false)"><i class='intelicon-check' style='font-size: 12px !important;'></i> Accept </button>
            </div>
        </ng-template>
    </kendo-grid-column>
    <kendo-grid-column [headerClass]="{'headerClass':true}" field="WIP_DEAL_OBJ_SID" width="120px" title="Contract" [hidden]="true">
        <ng-template kendoGridGroupHeaderTemplate let-group let-field="field" let-value="value">
            <div *ngIf="getUIelement(value)">
                <div *ngIf="isdealEndDateNeedChange">
                    <input type='checkbox' (click)="selectCheckBox(value)" [checked]="is_selected" class='check with-font' id='chkGrp" +value+ "' />
                    <span class="grpTitle" style='font-weight:bold'>{{value}}</span><i class='intelicon-arrow-back-left skyblue pl10'></i>
                    <span class='grpDesc' style='font-weight:bold;'>An overlap was located matching an Active or Draft deal.  In order to be able to create this new deal, the System will need to change the End date of the deal.  Is that ok?</span>&nbsp;
                    <button class='btn btn-sm btn-primary' (click)="acceptOvlp(value,'Y')">Yes</button>
                    <span class='or'>&nbsp;OR&nbsp;</span>
                    <button class='btn btn-sm btn-primary' (click)="rejectOvlp(value)">No</button>
                </div>
                <div *ngIf="isRevalidate">
                    <span class="grpTitle" style='font-weight:bold'>{{value}}</span>
                    <i class='intelicon-arrow-back-left skyblue pl10'></i>
                    <span class='grpDesc' style='font-weight:bold;'>An overlap was located matching another Draft deal.  Please correct and revalidate.</span>&nbsp;
                    <button class='btn btn-sm btn-primary' (click)="rejectOvlp(value)">Yes</button>
                </div>
                <div *ngIf="isDealEndDateChange">
                    <span class="grpTitle" style='font-weight:bold'>{{value}} </span>
                    <i class='intelicon-arrow-back-left skyblue pl10'></i>
                    <span class='grpDesc' style='font-weight:bold;'>An overlap was located matching an Active or Draft deal.  In order to be able to create this new deal, the System will need to change the End date of the deal.  Is that ok?</span>&nbsp;
                    <button class='btn btn-sm btn-primary' (click)="acceptOvlp(value,'N')">Undo</button>
                </div>
                <div *ngIf="isReqChange">
                    <span class="grpTitle" style='font-weight:bold'>{{value}}</span>
                    <i class='intelicon-arrow-back-left skyblue pl10'></i>
                    <span class='grpDesc' style='font-weight:bold;letter-spacing:0.07em '>Please correct and revalidate.</span>
                </div>
            </div>
        </ng-template>

    </kendo-grid-column>
    <kendo-grid-column [headerClass]="{'headerClass':true}" field="OVLP_DEAL_OBJ_SID" width="150" title="Deal #">
        <ng-template kendoGridFilterMenuTemplate let-column="column" let-filter="filter"
                     let-filterService="filterService">
            <multicheck-filter [isPrimitive]="true" [field]="column.field" [currentFilter]="filter"
                               [filterService]="filterService" [data]="distinctPrimitive(column.field)"></multicheck-filter>
        </ng-template>
    </kendo-grid-column>
    <kendo-grid-column [headerClass]="{'headerClass':true}" width="150" title="Contract">
        <ng-template kendoGridCellTemplate let-dataItem="dataItem">
            <div class="text-center">
                {{dataItem.CONTRACT_NM}}({{dataItem.CONTRACT_NBR}})
            </div>
        </ng-template>
        <ng-template kendoGridFilterMenuTemplate let-column="column" let-filter="filter"
                     let-filterService="filterService">
            <multicheck-filter [isPrimitive]="true" [field]="column.field" [currentFilter]="filter"
                               [filterService]="filterService" [data]="distinctPrimitive(column.field)"></multicheck-filter>
        </ng-template>
    </kendo-grid-column>
    <kendo-grid-column [headerClass]="{'headerClass':true}" width="150" title="Pricing Stratergy">
        <ng-template kendoGridCellTemplate let-dataItem="dataItem">
            <div class="text-center">
                {{dataItem.PRICE_STRATEGY_NM}}({{dataItem.PRICE_STRATEGY}})
            </div>
        </ng-template>
        <ng-template kendoGridFilterMenuTemplate let-column="column" let-filter="filter"
                     let-filterService="filterService">
            <multicheck-filter [isPrimitive]="true" [field]="column.field" [currentFilter]="filter"
                               [filterService]="filterService" [data]="distinctPrimitive(column.field)"></multicheck-filter>
        </ng-template>
    </kendo-grid-column>
    <kendo-grid-column [headerClass]="{'headerClass':true}" field="PRICING_TABLES" width="150" title="Pricing Table">
        <ng-template kendoGridCellTemplate let-dataItem="dataItem">
            <div class="text-center">
                {{dataItem.PRICING_TABLES_NM}}({{dataItem.PRICING_TABLES}})
            </div>
        </ng-template>
        <ng-template kendoGridFilterMenuTemplate let-column="column" let-filter="filter"
                     let-filterService="filterService">
            <multicheck-filter [isPrimitive]="true" [field]="column.field" [currentFilter]="filter"
                               [filterService]="filterService" [data]="distinctPrimitive(column.field)"></multicheck-filter>
        </ng-template>
    </kendo-grid-column>
    <kendo-grid-column [headerClass]="{'headerClass':true}" field="WF_STG_CD" width="150" title="Stage">
        <ng-template kendoGridFilterMenuTemplate let-column="column" let-filter="filter"
                     let-filterService="filterService">
            <multicheck-filter [isPrimitive]="true" [field]="column.field" [currentFilter]="filter"
                               [filterService]="filterService" [data]="distinctPrimitive(column.field)"></multicheck-filter>
        </ng-template>
    </kendo-grid-column>
    <kendo-grid-column [headerClass]="{'headerClass':true}" field="CUST_ACCNT_DIV" width="150" title="Customer Division">
        <ng-template kendoGridFilterMenuTemplate let-column="column" let-filter="filter"
                     let-filterService="filterService">
            <multicheck-filter [isPrimitive]="true" [field]="column.field" [currentFilter]="filter"
                               [filterService]="filterService" [data]="distinctPrimitive(column.field)"></multicheck-filter>
        </ng-template>
    </kendo-grid-column>
    <kendo-grid-column [headerClass]="{'headerClass':true}" field="PRODUCT_NM" width="150" title="My Deals Product">
        <ng-template kendoGridFilterMenuTemplate let-column="column" let-filter="filter"
                     let-filterService="filterService">
            <multicheck-filter [isPrimitive]="true" [field]="column.field" [currentFilter]="filter"
                               [filterService]="filterService" [data]="distinctPrimitive(column.field)"></multicheck-filter>
        </ng-template>
    </kendo-grid-column>
    <kendo-grid-column [headerClass]="{'headerClass':true}" field="GEO_COMBINED" width="150" title="Geo">
        <ng-template kendoGridFilterMenuTemplate let-column="column" let-filter="filter"
                     let-filterService="filterService">
            <multicheck-filter [isPrimitive]="true" [field]="column.field" [currentFilter]="filter"
                               [filterService]="filterService" [data]="distinctPrimitive(column.field)"></multicheck-filter>
        </ng-template>
    </kendo-grid-column>
    <kendo-grid-column [headerClass]="{'headerClass':true}" field="SOLD_TO_ID" width="150" title="Sold to ID">
        <ng-template kendoGridFilterMenuTemplate let-column="column" let-filter="filter"
                     let-filterService="filterService">
            <multicheck-filter [isPrimitive]="true" [field]="column.field" [currentFilter]="filter"
                               [filterService]="filterService" [data]="distinctPrimitive(column.field)"></multicheck-filter>
        </ng-template>
    </kendo-grid-column>
    <kendo-grid-column [headerClass]="{'headerClass':true}" field="START_DT" width="150" title="Deal Start Date"></kendo-grid-column>
    <kendo-grid-column [headerClass]="{'headerClass':true}" field="END_DT" width="150" title="Deal End Date"></kendo-grid-column>
    <kendo-grid-column [headerClass]="{'headerClass':true}" field="ECAP_PRICE" width="150" title="ECAP Price">
        <ng-template kendoGridFilterMenuTemplate let-column="column" let-filter="filter"
                     let-filterService="filterService">
            <multicheck-filter [isPrimitive]="true" [field]="column.field" [currentFilter]="filter"
                               [filterService]="filterService" [data]="distinctPrimitive(column.field)"></multicheck-filter>
        </ng-template>
    </kendo-grid-column>
    <kendo-grid-column [headerClass]="{'headerClass':true}" field="DEAL_COMB_TYPE" width="150" title="Additive">
        <ng-template kendoGridFilterMenuTemplate let-column="column" let-filter="filter"
                     let-filterService="filterService">
            <multicheck-filter [isPrimitive]="true" [field]="column.field" [currentFilter]="filter"
                               [filterService]="filterService" [data]="distinctPrimitive(column.field)"></multicheck-filter>
        </ng-template>
    </kendo-grid-column>
    <kendo-grid-column [headerClass]="{'headerClass':true}" field="ECAP_TYPE" width="150" title="ECAP Type">
        <ng-template kendoGridFilterMenuTemplate let-column="column" let-filter="filter"
                     let-filterService="filterService">
            <multicheck-filter [isPrimitive]="true" [field]="column.field" [currentFilter]="filter"
                               [filterService]="filterService" [data]="distinctPrimitive(column.field)"></multicheck-filter>
        </ng-template>
    </kendo-grid-column>
    <kendo-grid-column [headerClass]="{'headerClass':true}" field="MRKT_SEG" width="150" title="Market Segment">
        <ng-template kendoGridFilterMenuTemplate let-column="column" let-filter="filter"
                     let-filterService="filterService">
            <multicheck-filter [isPrimitive]="true" [field]="column.field" [currentFilter]="filter"
                               [filterService]="filterService" [data]="distinctPrimitive(column.field)"></multicheck-filter>
        </ng-template>
    </kendo-grid-column>
</kendo-grid>
<div class="k-widget k-dialog k-window k-alert" *ngIf="showKendoAlert">
    <kendo-dialog (close)="closeKendoAlert()">
        <i class='fa fa-check' aria-hidden='true'
           style='margin-right: 10px;'></i><div style='margin-top: 15px;'>
            Please go to <b>Deal Editor</b>; <b>edit</b> and <b>re-validate</b> your deal to avoid overlapping with other deals.
        </div>
        <kendo-dialog-actions>
            <div kendoButton (click)="closeKendoAlert()" class="kendo-alrt-btn">OK</div>
        </kendo-dialog-actions>
    </kendo-dialog>
</div>